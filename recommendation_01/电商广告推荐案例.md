

```python
!hadoop fs -ls /
```

    Found 17 items
    drwxr-xr-x   - root supergroup          0 2019-05-24 03:07 /data
    -rw-r--r--   1 root supergroup   24056588 2019-05-24 03:07 /datt
    drwxr-xr-x   - root supergroup          0 2019-03-20 17:11 /flume
    drwxr-xr-x   - root supergroup          0 2019-08-08 20:28 /hbase
    -rw-r--r--   1 root supergroup       4662 2019-05-21 15:39 /iris.csv
    drwxr-xr-x   - root supergroup          0 2019-07-25 20:14 /models
    -rw-r--r--   3 root supergroup     103459 2019-03-19 17:11 /movie_comment.json
    drwxr-xr-x   - root supergroup          0 2019-08-06 12:58 /output
    drwxr-xr-x   - root supergroup          0 2019-08-06 22:23 /root
    drwxr-xr-x   - root supergroup          0 2019-08-06 20:17 /test
    drwxr-xr-x   - root supergroup          0 2019-08-06 20:15 /test.txt
    
    -rw-r--r--   1 root supergroup         20 2019-05-18 03:10 /test1.txt
    drwxr-xr-x   - root supergroup          0 2019-05-20 08:26 /tmp
    -rw-r--r--   1 root supergroup        152 2019-05-20 03:19 /udf.py
    drwxr-xr-x   - root supergroup          0 2019-01-05 00:10 /user
    drwxr-xr-x   - root supergroup          0 2019-03-21 11:01 /workspace
    -rw-r--r--   1 root supergroup    3182409 2019-05-21 16:35 /zips.json



```python
!hadoop fs -ls /data
```

    Found 4 items
    -rw-r--r--   1 root supergroup   31286431 2019-05-24 01:38 /data/ad_feature.csv
    -rw-r--r--   1 root supergroup 1088060964 2019-05-24 01:15 /data/raw_sample.csv
    -rw-r--r--   1 root supergroup  338058519 2019-05-23 23:30 /data/test1.csv
    -rw-r--r--   1 root supergroup   24056588 2019-05-24 03:07 /data/user_profile.csv



```python
!hadoop fs -ls /models
```

    Found 3 items
    drwxr-xr-x   - root supergroup          0 2019-05-24 00:45 /models/CTRModel_AllOneHot.obj
    drwxr-xr-x   - root supergroup          0 2019-07-25 20:14 /models/CTRModel_Normal.obj
    drwxr-xr-x   - root supergroup          0 2019-05-24 00:45 /models/userCateRatingALSModel.obj



```python
!ls
```

    20090121000132.394251.http.format  reduce.py
    access.log			   sparkipcount.py
    ad_feature.csv			   SparkSQL&SparkStreaming.ipynb
    article_keywords.txt		   sparkstreamingtest.py
    checkpoint			   sparkupdatestatebykey.py
    employee.txt			   spark-warehouse
    ip.txt				   sparkwctest1.py
    iris.csv			   sparkwindow.py
    map.py				   streaming.py
    mrjobtest			   streaming.sh
    mrjobtest.py			   student.txt
    mrjobtopn			   test1.csv
    mrjobtopn1.py			   test1.txt
    mrjobtopn.py			   test3.txt
    mrjobwc1.py			   test4.csv
    mrjobwc2.py			   test.py
    mrjobwc.py			   test.txt
    mrjobwordcount			   udf.py
    mrjobwordcount.py		   updatestatebykeytest.py
    mrtopn1.py			   user_action.txt
    mrtopn.py			   user_profile.csv
    pysparkip.py			   windowstest.py
    pysparkpv.py			   zips.json
    pysparkstreamingtest.py		   zookeeper-3.4.14.tar.gz
    pysparktopn.py			   电商广告推荐.ipynb
    pysparkuv.py			   电商广告推荐案例.ipynb
    raw_sample.csv			   未命名.ipynb



```python
import pandas as pd
```


```python
chunks = pd.read_csv('test1.csv',chunksize = 100,iterator = True)
```


```python
counter = 0
for chunk in chunks:
    counter += 1
    if counter ==1:
        chunk.to_csv('test2.csv',index = False)
    elif counter>1 and counter<=100:
        chunk.to_csv('test2.csv',index = False,header = False,mode = 'a')
    else:
        break
```


```python
pd.read_csv('test2.csv')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user</th>
      <th>time_stamp</th>
      <th>btag</th>
      <th>cate</th>
      <th>brand</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>469297</td>
      <td>1493798438</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>1</th>
      <td>202381</td>
      <td>1493789210</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>2</th>
      <td>202381</td>
      <td>1493790165</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>3</th>
      <td>202381</td>
      <td>1493790141</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>4</th>
      <td>202381</td>
      <td>1493790114</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>5</th>
      <td>202381</td>
      <td>1493790081</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>6</th>
      <td>202381</td>
      <td>1493790041</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>7</th>
      <td>202381</td>
      <td>1493789210</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>8</th>
      <td>202381</td>
      <td>1493789907</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>9</th>
      <td>202381</td>
      <td>1493789203</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>10</th>
      <td>202381</td>
      <td>1493789192</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>11</th>
      <td>202381</td>
      <td>1493789846</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>12</th>
      <td>202381</td>
      <td>1493789819</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>13</th>
      <td>202381</td>
      <td>1493789458</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>14</th>
      <td>202381</td>
      <td>1493789376</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>15</th>
      <td>202381</td>
      <td>1493789376</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>16</th>
      <td>202381</td>
      <td>1493789371</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>17</th>
      <td>202381</td>
      <td>1493789371</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>18</th>
      <td>202381</td>
      <td>1493789367</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>19</th>
      <td>202381</td>
      <td>1493789367</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>20</th>
      <td>202381</td>
      <td>1493789363</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>21</th>
      <td>202381</td>
      <td>1493789363</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>22</th>
      <td>202381</td>
      <td>1493789350</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>23</th>
      <td>202381</td>
      <td>1493789332</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>24</th>
      <td>202381</td>
      <td>1493789216</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>25</th>
      <td>202381</td>
      <td>1493789216</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>26</th>
      <td>783751</td>
      <td>1493809358</td>
      <td>cart</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>27</th>
      <td>403239</td>
      <td>1493805762</td>
      <td>cart</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>28</th>
      <td>1099239</td>
      <td>1493817226</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>29</th>
      <td>1099239</td>
      <td>1493817226</td>
      <td>pv</td>
      <td>431</td>
      <td>31628</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>9970</th>
      <td>501673</td>
      <td>1493784196</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9971</th>
      <td>252844</td>
      <td>1493824234</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9972</th>
      <td>567837</td>
      <td>1493820095</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9973</th>
      <td>840684</td>
      <td>1493819790</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9974</th>
      <td>790755</td>
      <td>1493816249</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9975</th>
      <td>790755</td>
      <td>1493816364</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9976</th>
      <td>790755</td>
      <td>1493816269</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9977</th>
      <td>790755</td>
      <td>1493816356</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9978</th>
      <td>790755</td>
      <td>1493816356</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9979</th>
      <td>790755</td>
      <td>1493816328</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9980</th>
      <td>790755</td>
      <td>1493816328</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9981</th>
      <td>790755</td>
      <td>1493816325</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9982</th>
      <td>790755</td>
      <td>1493816325</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9983</th>
      <td>790755</td>
      <td>1493816315</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9984</th>
      <td>790755</td>
      <td>1493816315</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9985</th>
      <td>790755</td>
      <td>1493815308</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9986</th>
      <td>790755</td>
      <td>1493816189</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9987</th>
      <td>790755</td>
      <td>1493816365</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9988</th>
      <td>919281</td>
      <td>1493783080</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9989</th>
      <td>919281</td>
      <td>1493783086</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9990</th>
      <td>919281</td>
      <td>1493783086</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9991</th>
      <td>919281</td>
      <td>1493783058</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9992</th>
      <td>919281</td>
      <td>1493783061</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9993</th>
      <td>919281</td>
      <td>1493783066</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9994</th>
      <td>919281</td>
      <td>1493783066</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9995</th>
      <td>919281</td>
      <td>1493783073</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9996</th>
      <td>919281</td>
      <td>1493783073</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9997</th>
      <td>919281</td>
      <td>1493783077</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9998</th>
      <td>919281</td>
      <td>1493783077</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
    <tr>
      <th>9999</th>
      <td>919281</td>
      <td>1493783080</td>
      <td>pv</td>
      <td>6261</td>
      <td>43811</td>
    </tr>
  </tbody>
</table>
<p>10000 rows × 5 columns</p>
</div>




```python
import os
# 配置spark driver和pyspark运行时，所使用的python解释器路径
PYSPARK_PYTHON = "/miniconda2/envs/py365/bin/python"
JAVA_HOME='/root/bigdata/jdk'
SPARK_HOME = "/root/bigdata/spark"
# 当存在多个版本时，不指定很可能会导致出错
os.environ["PYSPARK_PYTHON"] = PYSPARK_PYTHON
os.environ["PYSPARK_DRIVER_PYTHON"] = PYSPARK_PYTHON
os.environ['JAVA_HOME']=JAVA_HOME
os.environ["SPARK_HOME"] = SPARK_HOME
# spark配置信息
from pyspark import SparkConf
from pyspark.sql import SparkSession

SPARK_APP_NAME = "preprocessingBehaviorLog"
SPARK_URL = "spark://192.168.2.137:7077"

conf = SparkConf()    # 创建spark config对象
config = (
    ("spark.app.name", SPARK_APP_NAME),    # 设置启动的spark的app名称，没有提供，将随机产生一个名称
    ("spark.executor.memory", "6g"),    # 设置该app启动时占用的内存用量，默认1g
    ("spark.master", SPARK_URL),    # spark master的地址
    ("spark.executor.cores", "4"),    # 设置spark executor使用的CPU核心数
)
# 查看更详细配置及说明：https://spark.apache.org/docs/latest/configuration.html

conf.setAll(config)

# 利用config对象，创建spark session
spark = SparkSession.builder.config(conf=conf).getOrCreate()
```


```python
df = spark.read.csv('/data/test1.csv',header= True)
```


```python
df.printSchema()
```

    root
     |-- user: string (nullable = true)
     |-- time_stamp: string (nullable = true)
     |-- btag: string (nullable = true)
     |-- cate: string (nullable = true)
     |-- brand: string (nullable = true)


​    


```python
df.show()
```

    +------+----------+----+-----+------+
    |  user|time_stamp|btag| cate| brand|
    +------+----------+----+-----+------+
    |558157|1493741625|  pv| 6250| 91286|
    |558157|1493741626|  pv| 6250| 91286|
    |558157|1493741627|  pv| 6250| 91286|
    |728690|1493776998|  pv|11800| 62353|
    |332634|1493809895|  pv| 1101|365477|
    |857237|1493816945|  pv| 1043|110616|
    |619381|1493774638|  pv|  385|428950|
    |467042|1493772641|  pv| 8237|301299|
    |467042|1493772644|  pv| 8237|301299|
    |991528|1493780710|  pv| 7270|274795|
    |991528|1493780712|  pv| 7270|274795|
    |991528|1493780712|  pv| 7270|274795|
    |991528|1493780712|  pv| 7270|274795|
    |991528|1493780714|  pv| 7270|274795|
    |991528|1493780765|  pv| 7270|274795|
    |991528|1493780714|  pv| 7270|274795|
    |991528|1493780765|  pv| 7270|274795|
    |991528|1493780764|  pv| 7270|274795|
    |991528|1493780633|  pv| 7270|274795|
    |991528|1493780764|  pv| 7270|274795|
    +------+----------+----+-----+------+
    only showing top 20 rows


​    


```python
df.count()
```




    10000000




```python
from pyspark.sql.types import StructType, StructField, StringType, IntegerType, LongType
# 构建结构对象
schema = StructType([
    StructField("userId", IntegerType()),
    StructField("timestamp", LongType()),
    StructField("btag", StringType()),
    StructField("cateId", IntegerType()),
    StructField("brandId", IntegerType())
])
# 从hdfs加载数据为dataframe，并设置结构
behavior_log_df = spark.read.csv("/data/test1.csv", header=True, schema=schema)
behavior_log_df.show()
```

    +------+----------+----+------+-------+
    |userId| timestamp|btag|cateId|brandId|
    +------+----------+----+------+-------+
    |558157|1493741625|  pv|  6250|  91286|
    |558157|1493741626|  pv|  6250|  91286|
    |558157|1493741627|  pv|  6250|  91286|
    |728690|1493776998|  pv| 11800|  62353|
    |332634|1493809895|  pv|  1101| 365477|
    |857237|1493816945|  pv|  1043| 110616|
    |619381|1493774638|  pv|   385| 428950|
    |467042|1493772641|  pv|  8237| 301299|
    |467042|1493772644|  pv|  8237| 301299|
    |991528|1493780710|  pv|  7270| 274795|
    |991528|1493780712|  pv|  7270| 274795|
    |991528|1493780712|  pv|  7270| 274795|
    |991528|1493780712|  pv|  7270| 274795|
    |991528|1493780714|  pv|  7270| 274795|
    |991528|1493780765|  pv|  7270| 274795|
    |991528|1493780714|  pv|  7270| 274795|
    |991528|1493780765|  pv|  7270| 274795|
    |991528|1493780764|  pv|  7270| 274795|
    |991528|1493780633|  pv|  7270| 274795|
    |991528|1493780764|  pv|  7270| 274795|
    +------+----------+----+------+-------+
    only showing top 20 rows


​    

- 查看数据的情况


```python
#数据中有多少个用户
behavior_log_df.groupBy('userId').count().show()
```

    +-------+-----+
    | userId|count|
    +-------+-----+
    |  57178|   54|
    | 747610|    8|
    |1081474|    3|
    | 694901|   10|
    | 920750|   70|
    |  35361|   16|
    | 961035|    5|
    | 155430|    6|
    | 493421|   49|
    | 897491|    4|
    |  47217|   18|
    | 976417|   28|
    | 295048|    7|
    | 876272|   26|
    | 495753|    8|
    | 691528|   52|
    |1131890|   98|
    | 763546|    1|
    | 753966|    6|
    | 300779|    9|
    +-------+-----+
    only showing top 20 rows


​    


```python
behavior_log_df.groupBy('userId').count().count()
```




    745163




```python
behavior_log_df.groupBy('btag').count().show()
```

    +----+-------+
    |btag|  count|
    +----+-------+
    | buy| 130132|
    | fav| 129493|
    |cart| 220382|
    |  pv|9519993|
    +----+-------+


​    


```python
behavior_log_df.groupBy('cateId').count().count()
```




    9294




```python
behavior_log_df.groupBy('brandId').count().count()
```




    170718




```python
behavior_log_df.dropna().count()
```




    10000000




```python
# 统计 每一个用户 对不同类别的用户行为数量 
# user-cate rating   user-brand rating
cate_count_df = behavior_log_df.groupBy(behavior_log_df.userId,behavior_log_df.cateId).pivot('btag').count()
```


```python
cate_count_df.show()
```

    +-------+------+----+----+----+----+
    | userId|cateId| buy|cart| fav|  pv|
    +-------+------+----+----+----+----+
    | 738396|  9687|null|   1|null|  13|
    | 590694|  6432|null|null|null|   3|
    |1056983|  4283|null|   1|null|  31|
    | 950232|  5953|null|null|null|   1|
    | 386718|  9295|null|null|null|  14|
    | 420528|  9494|null|null|null|  25|
    | 556217|  4520|null|null|null|   6|
    | 985125|  8882|   1|null|null|null|
    | 199025|  6251|null|   2|null|   2|
    |  99730|  4267|null|null|   1|   2|
    | 244032|  6421|null|null|null|   1|
    | 144924|   591|null|null|null|   4|
    | 970608|  5139|null|null|null|   4|
    |  95196|  4505|null|null|null|   1|
    | 275462|  6250|null|null|null|   1|
    |1017870|  5751|null|null|   1|   4|
    | 645845|  7146|null|null|null|   1|
    |  42724|  6935|   1|null|null|   5|
    | 256963|  1102|   1|null|null|   1|
    | 982086|  4280|null|   1|null|   9|
    +-------+------+----+----+----+----+
    only showing top 20 rows


​    


```python
cate_count_df = behavior_log_df.groupBy(behavior_log_df.userId,behavior_log_df.cateId).pivot('btag',['pv','fav','cart','buy']).count()
```


```python
cate_count_df.show()
```

    +-------+------+----+----+----+----+
    | userId|cateId|  pv| fav|cart| buy|
    +-------+------+----+----+----+----+
    | 738396|  9687|  13|null|   1|null|
    | 590694|  6432|   3|null|null|null|
    |1056983|  4283|  31|null|   1|null|
    | 950232|  5953|   1|null|null|null|
    | 386718|  9295|  14|null|null|null|
    | 420528|  9494|  25|null|null|null|
    | 556217|  4520|   6|null|null|null|
    | 985125|  8882|null|null|null|   1|
    | 199025|  6251|   2|null|   2|null|
    |  99730|  4267|   2|   1|null|null|
    | 244032|  6421|   1|null|null|null|
    | 144924|   591|   4|null|null|null|
    | 970608|  5139|   4|null|null|null|
    |  95196|  4505|   1|null|null|null|
    | 275462|  6250|   1|null|null|null|
    |1017870|  5751|   4|   1|null|null|
    | 645845|  7146|   1|null|null|null|
    |  42724|  6935|   5|null|null|   1|
    | 256963|  1102|   1|null|null|   1|
    | 982086|  4280|   9|null|   1|null|
    +-------+------+----+----+----+----+
    only showing top 20 rows


​    


```python
spark.sparkContext.setCheckpointDir("/checkPoint/")
```


```python
!hdfs dfsadmin -safemode leave
```

    Safe mode is OFF



```python
def process_row(r):
    #先初始化数据 把null的情况改成0
    pv_count = r.pv if r.pv else 0.0
    fav_count = r.fav if r.fav else 0.0
    cart_count = r.cart if r.cart else 0.0
    buy_count = r.buy if r.buy else 0.0
    
    pv_score = 0.2*pv_count if pv_count<=20 else 4.0
    fav_score = 0.4*fav_count if fav_count<=20 else 8.0
    cart_score = 0.6*cart_count if cart_count<=20 else 12.0
    buy_score = 1.0*buy_count if buy_count<=20 else 20.0
    
    rating = pv_score+fav_score+cart_score+buy_score
    return r.userId,r.cateId,rating
```


```python
cate_rating_df = cate_count_df.rdd.map(process_row).toDF(['userId','cateId','rating'])
```


```python
cate_rating_df.show()
```

    +-------+------+------------------+
    | userId|cateId|            rating|
    +-------+------+------------------+
    | 738396|  9687|               3.2|
    | 590694|  6432|0.6000000000000001|
    |1056983|  4283|               4.6|
    | 950232|  5953|               0.2|
    | 386718|  9295|2.8000000000000003|
    | 420528|  9494|               4.0|
    | 556217|  4520|1.2000000000000002|
    | 985125|  8882|               1.0|
    | 199025|  6251|               1.6|
    |  99730|  4267|               0.8|
    | 244032|  6421|               0.2|
    | 144924|   591|               0.8|
    | 970608|  5139|               0.8|
    |  95196|  4505|               0.2|
    | 275462|  6250|               0.2|
    |1017870|  5751|1.2000000000000002|
    | 645845|  7146|               0.2|
    |  42724|  6935|               2.0|
    | 256963|  1102|               1.2|
    | 982086|  4280|               2.4|
    +-------+------+------------------+
    only showing top 20 rows


​    

### 使用ALS模块训练协同过滤模型


```python
from pyspark.ml.recommendation import ALS
als = ALS(userCol = 'userId',itemCol = 'cateId',ratingCol = 'rating',checkpointInterval=10)
model = als.fit(cate_rating_df)
```


```python
# 为每一个用户推荐三个物品 这里是3个类别
result = model.recommendForAllUsers(3)
```


```python
result.show(truncate = False)
```

    +------+---------------------------------------------------------+
    |userId|recommendations                                          |
    +------+---------------------------------------------------------+
    |463   |[[10029,3.391169], [8666,3.3452797], [7525,3.0162396]]   |
    |471   |[[5595,1.5155851], [4470,1.3434007], [8412,1.1821244]]   |
    |496   |[[6133,0.24667734], [1566,0.22688869], [4667,0.2243293]] |
    |833   |[[9303,2.7552729], [8666,2.5706155], [4667,2.5017495]]   |
    |1088  |[[9963,0.49602544], [11991,0.487787], [7525,0.4662412]]  |
    |1238  |[[7777,3.6310313], [4783,3.4562442], [11614,3.3763962]]  |
    |1342  |[[5595,5.098918], [2770,3.3178413], [8508,3.1516023]]    |
    |1580  |[[12000,0.3162635], [7777,0.3084701], [1460,0.2972801]]  |
    |1591  |[[10115,0.41442364], [4470,0.3662976], [7777,0.36311114]]|
    |1645  |[[8930,0.50786716], [8412,0.49716762], [4470,0.4959578]] |
    |1829  |[[1460,1.5267019], [9442,1.5058434], [6921,1.3868906]]   |
    |1959  |[[7777,0.6735717], [1566,0.66946703], [3766,0.5720526]]  |
    |2142  |[[4472,1.2270342], [9303,1.0213128], [5595,1.0086662]]   |
    |2659  |[[5595,7.653881], [650,7.3318095], [2176,7.130057]]      |
    |3794  |[[8666,0.5384508], [2614,0.500104], [12433,0.4362553]]   |
    |3918  |[[7777,0.24617377], [650,0.23663263], [8219,0.23492163]] |
    |3997  |[[5595,0.85095096], [4472,0.64119375], [9303,0.60674757]]|
    |4519  |[[1566,5.246213], [7777,3.9899476], [1861,3.8716912]]    |
    |4900  |[[5595,3.893915], [2176,2.102544], [7777,2.0097291]]     |
    |4935  |[[4783,1.7301464], [3766,1.6708479], [1566,1.6357906]]   |
    +------+---------------------------------------------------------+
    only showing top 20 rows


​    


```python
#模型的保存和加载
from pyspark.ml.recommendation import ALSModel
als_model = ALSModel.load('/models/userCateRatingALSModel.obj')
```


```python
als_model.recommendForAllUsers(3).show()
```


    ---------------------------------------------------------------------------
    
    KeyboardInterrupt                         Traceback (most recent call last)
    
    <ipython-input-41-9194f0c992b3> in <module>
    ----> 1 als_model.recommendForAllUsers(3).show()


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/sql/dataframe.py in show(self, n, truncate)
        334         """
        335         if isinstance(truncate, bool) and truncate:
    --> 336             print(self._jdf.showString(n, 20))
        337         else:
        338             print(self._jdf.showString(n, int(truncate)))


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in __call__(self, *args)
       1253             proto.END_COMMAND_PART
       1254 
    -> 1255         answer = self.gateway_client.send_command(command)
       1256         return_value = get_return_value(
       1257             answer, self.gateway_client, self.target_id, self.name)


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in send_command(self, command, retry, binary)
        983         connection = self._get_connection()
        984         try:
    --> 985             response = connection.send_command(command)
        986             if binary:
        987                 return response, self._create_connection_guard(connection)


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in send_command(self, command)
       1150 
       1151         try:
    -> 1152             answer = smart_decode(self.stream.readline()[:-1])
       1153             logger.debug("Answer received: {0}".format(answer))
       1154             if answer.startswith(proto.RETURN_MESSAGE):


    /miniconda2/envs/py365/lib/python3.6/socket.py in readinto(self, b)
        584         while True:
        585             try:
    --> 586                 return self._sock.recv_into(b)
        587             except timeout:
        588                 self._timeout_occurred = True


    KeyboardInterrupt: 



```python
import redis
host = '192.168.2.137'
port = 6379
def recall_cate_by_cf(partition):
    #建立redis连接池
    pool = redis.ConnectionPool(host = host,port=port)
    #建立redis客户端
    client = redis.Redis(connection_pool=pool)
    #遍历partition中的数据
    for row in partition:
        client.hset('recall_cate1',row.userId,[i.cateId for i in row.recommendations])
result.foreachPartition(recall_cate_by_cf)
```

### CTR预估数据准备


```python
df = spark.read.csv('/data/raw_sample.csv',header = True)
```


```python
df.printSchema()
```

    root
     |-- user: string (nullable = true)
     |-- time_stamp: string (nullable = true)
     |-- adgroup_id: string (nullable = true)
     |-- pid: string (nullable = true)
     |-- nonclk: string (nullable = true)
     |-- clk: string (nullable = true)


​    


```python
df.show()
```

    +------+----------+----------+-----------+------+---+
    |  user|time_stamp|adgroup_id|        pid|nonclk|clk|
    +------+----------+----------+-----------+------+---+
    |581738|1494137644|         1|430548_1007|     1|  0|
    |449818|1494638778|         3|430548_1007|     1|  0|
    |914836|1494650879|         4|430548_1007|     1|  0|
    |914836|1494651029|         5|430548_1007|     1|  0|
    |399907|1494302958|         8|430548_1007|     1|  0|
    |628137|1494524935|         9|430548_1007|     1|  0|
    |298139|1494462593|         9|430539_1007|     1|  0|
    |775475|1494561036|         9|430548_1007|     1|  0|
    |555266|1494307136|        11|430539_1007|     1|  0|
    |117840|1494036743|        11|430548_1007|     1|  0|
    |739815|1494115387|        11|430539_1007|     1|  0|
    |623911|1494625301|        11|430548_1007|     1|  0|
    |623911|1494451608|        11|430548_1007|     1|  0|
    |421590|1494034144|        11|430548_1007|     1|  0|
    |976358|1494156949|        13|430548_1007|     1|  0|
    |286630|1494218579|        13|430539_1007|     1|  0|
    |286630|1494289247|        13|430539_1007|     1|  0|
    |771431|1494153867|        13|430548_1007|     1|  0|
    |707120|1494220810|        13|430548_1007|     1|  0|
    |530454|1494293746|        13|430548_1007|     1|  0|
    +------+----------+----------+-----------+------+---+
    only showing top 20 rows


​    


```python
#总体数据量
df.count()
```




    26557961




```python
df.groupBy('user').count().count()
```




    1141729




```python
df.groupBy('adgroup_id').count().count()
```




    846811




```python
df.groupBy('pid').count().show()
```

    +-----------+--------+
    |        pid|   count|
    +-----------+--------+
    |430548_1007|16472898|
    |430539_1007|10085063|
    +-----------+--------+


​    


```python
#点击的情况
df.groupBy('clk').count().collect()
```




    [Row(clk='0', count=25191905), Row(clk='1', count=1366056)]




```python
# 更改表结构，转换为对应的数据类型
from pyspark.sql.types import StructType, StructField, IntegerType, FloatType, LongType, StringType

# 打印df结构信息
df.printSchema()   
# 更改df表结构：更改列类型和列名称
raw_sample_df = df.\
    withColumn("user", df.user.cast(IntegerType())).withColumnRenamed("user", "userId").\
    withColumn("time_stamp", df.time_stamp.cast(LongType())).withColumnRenamed("time_stamp", "timestamp").\
    withColumn("adgroup_id", df.adgroup_id.cast(IntegerType())).withColumnRenamed("adgroup_id", "adgroupId").\
    withColumn("pid", df.pid.cast(StringType())).\
    withColumn("nonclk", df.nonclk.cast(IntegerType())).\
    withColumn("clk", df.clk.cast(IntegerType()))
raw_sample_df.printSchema()
raw_sample_df.show()
```

    root
     |-- user: string (nullable = true)
     |-- time_stamp: string (nullable = true)
     |-- adgroup_id: string (nullable = true)
     |-- pid: string (nullable = true)
     |-- nonclk: string (nullable = true)
     |-- clk: string (nullable = true)
    
    root
     |-- userId: integer (nullable = true)
     |-- timestamp: long (nullable = true)
     |-- adgroupId: integer (nullable = true)
     |-- pid: string (nullable = true)
     |-- nonclk: integer (nullable = true)
     |-- clk: integer (nullable = true)
    
    +------+----------+---------+-----------+------+---+
    |userId| timestamp|adgroupId|        pid|nonclk|clk|
    +------+----------+---------+-----------+------+---+
    |581738|1494137644|        1|430548_1007|     1|  0|
    |449818|1494638778|        3|430548_1007|     1|  0|
    |914836|1494650879|        4|430548_1007|     1|  0|
    |914836|1494651029|        5|430548_1007|     1|  0|
    |399907|1494302958|        8|430548_1007|     1|  0|
    |628137|1494524935|        9|430548_1007|     1|  0|
    |298139|1494462593|        9|430539_1007|     1|  0|
    |775475|1494561036|        9|430548_1007|     1|  0|
    |555266|1494307136|       11|430539_1007|     1|  0|
    |117840|1494036743|       11|430548_1007|     1|  0|
    |739815|1494115387|       11|430539_1007|     1|  0|
    |623911|1494625301|       11|430548_1007|     1|  0|
    |623911|1494451608|       11|430548_1007|     1|  0|
    |421590|1494034144|       11|430548_1007|     1|  0|
    |976358|1494156949|       13|430548_1007|     1|  0|
    |286630|1494218579|       13|430539_1007|     1|  0|
    |286630|1494289247|       13|430539_1007|     1|  0|
    |771431|1494153867|       13|430548_1007|     1|  0|
    |707120|1494220810|       13|430548_1007|     1|  0|
    |530454|1494293746|       13|430548_1007|     1|  0|
    +------+----------+---------+-----------+------+---+
    only showing top 20 rows


​    


```python
from pyspark.ml.feature import OneHotEncoder
from pyspark.ml.feature import StringIndexer
from pyspark.ml import Pipeline
```


```python
# 利用StringIndexer 把分类特征处理成 从0开始计数的分类
stringIndexer = StringIndexer(inputCol = 'pid',outputCol = 'pid_feature')
strIndexer_model = stringIndexer.fit(raw_sample_df)
strInd_result = strIndexer_model.transform(raw_sample_df)
```


```python
strInd_result.show()
```

    +------+----------+---------+-----------+------+---+-----------+
    |userId| timestamp|adgroupId|        pid|nonclk|clk|pid_feature|
    +------+----------+---------+-----------+------+---+-----------+
    |581738|1494137644|        1|430548_1007|     1|  0|        0.0|
    |449818|1494638778|        3|430548_1007|     1|  0|        0.0|
    |914836|1494650879|        4|430548_1007|     1|  0|        0.0|
    |914836|1494651029|        5|430548_1007|     1|  0|        0.0|
    |399907|1494302958|        8|430548_1007|     1|  0|        0.0|
    |628137|1494524935|        9|430548_1007|     1|  0|        0.0|
    |298139|1494462593|        9|430539_1007|     1|  0|        1.0|
    |775475|1494561036|        9|430548_1007|     1|  0|        0.0|
    |555266|1494307136|       11|430539_1007|     1|  0|        1.0|
    |117840|1494036743|       11|430548_1007|     1|  0|        0.0|
    |739815|1494115387|       11|430539_1007|     1|  0|        1.0|
    |623911|1494625301|       11|430548_1007|     1|  0|        0.0|
    |623911|1494451608|       11|430548_1007|     1|  0|        0.0|
    |421590|1494034144|       11|430548_1007|     1|  0|        0.0|
    |976358|1494156949|       13|430548_1007|     1|  0|        0.0|
    |286630|1494218579|       13|430539_1007|     1|  0|        1.0|
    |286630|1494289247|       13|430539_1007|     1|  0|        1.0|
    |771431|1494153867|       13|430548_1007|     1|  0|        0.0|
    |707120|1494220810|       13|430548_1007|     1|  0|        0.0|
    |530454|1494293746|       13|430548_1007|     1|  0|        0.0|
    +------+----------+---------+-----------+------+---+-----------+
    only showing top 20 rows


​    


```python
encoder = OneHotEncoder(dropLast = False,inputCol='pid_feature',outputCol = 'pid_value')
```


```python
encoder_result = encoder.transform(strInd_result)
```


```python
encoder_result.show()
```

    +------+----------+---------+-----------+------+---+-----------+-------------+
    |userId| timestamp|adgroupId|        pid|nonclk|clk|pid_feature|    pid_value|
    +------+----------+---------+-----------+------+---+-----------+-------------+
    |581738|1494137644|        1|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |449818|1494638778|        3|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |914836|1494650879|        4|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |914836|1494651029|        5|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |399907|1494302958|        8|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |628137|1494524935|        9|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |298139|1494462593|        9|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |775475|1494561036|        9|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |555266|1494307136|       11|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |117840|1494036743|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |739815|1494115387|       11|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |623911|1494625301|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |623911|1494451608|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |421590|1494034144|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |976358|1494156949|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |286630|1494218579|       13|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |286630|1494289247|       13|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |771431|1494153867|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |707120|1494220810|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |530454|1494293746|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    +------+----------+---------+-----------+------+---+-----------+-------------+
    only showing top 20 rows


​    


```python
from pyspark.ml.linalg import SparseVector
# 参数：维度、非零元素的索引列表、值列表
print(SparseVector(4, [1, 3], [3.0, 4.0]))
print(SparseVector(4, [1, 3], [3.0, 4.0]).toArray())
```

    (4,[1,3],[3.0,4.0])
    [0. 3. 0. 4.]



```python
encoder1 = OneHotEncoder(dropLast = True,inputCol='pid_feature',outputCol = 'pid_value')
encoder1.transform(strInd_result).show()
# [0,0,1] [0,1,0] [1,0,0]   [1,0] [0,1] [0,0]
```

    +------+----------+---------+-----------+------+---+-----------+-------------+
    |userId| timestamp|adgroupId|        pid|nonclk|clk|pid_feature|    pid_value|
    +------+----------+---------+-----------+------+---+-----------+-------------+
    |581738|1494137644|        1|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |449818|1494638778|        3|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |914836|1494650879|        4|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |914836|1494651029|        5|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |399907|1494302958|        8|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |628137|1494524935|        9|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |298139|1494462593|        9|430539_1007|     1|  0|        1.0|    (1,[],[])|
    |775475|1494561036|        9|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |555266|1494307136|       11|430539_1007|     1|  0|        1.0|    (1,[],[])|
    |117840|1494036743|       11|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |739815|1494115387|       11|430539_1007|     1|  0|        1.0|    (1,[],[])|
    |623911|1494625301|       11|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |623911|1494451608|       11|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |421590|1494034144|       11|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |976358|1494156949|       13|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |286630|1494218579|       13|430539_1007|     1|  0|        1.0|    (1,[],[])|
    |286630|1494289247|       13|430539_1007|     1|  0|        1.0|    (1,[],[])|
    |771431|1494153867|       13|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |707120|1494220810|       13|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    |530454|1494293746|       13|430548_1007|     1|  0|        0.0|(1,[0],[1.0])|
    +------+----------+---------+-----------+------+---+-----------+-------------+
    only showing top 20 rows


​    


```python
# StringIndexer对指定字符串列进行特征处理
stringindexer = StringIndexer(inputCol='pid', outputCol='pid_feature')
# 对处理出来的特征处理列进行，热独编码
encoder = OneHotEncoder(dropLast=False, inputCol='pid_feature', outputCol='pid_value')
# 利用管道对每一个数据进行热独编码处理
pipeline = Pipeline(stages=[stringindexer, encoder])
pipeline_model = pipeline.fit(raw_sample_df)
new_df = pipeline_model.transform(raw_sample_df)
new_df.show()
```

    +------+----------+---------+-----------+------+---+-----------+-------------+
    |userId| timestamp|adgroupId|        pid|nonclk|clk|pid_feature|    pid_value|
    +------+----------+---------+-----------+------+---+-----------+-------------+
    |581738|1494137644|        1|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |449818|1494638778|        3|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |914836|1494650879|        4|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |914836|1494651029|        5|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |399907|1494302958|        8|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |628137|1494524935|        9|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |298139|1494462593|        9|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |775475|1494561036|        9|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |555266|1494307136|       11|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |117840|1494036743|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |739815|1494115387|       11|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |623911|1494625301|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |623911|1494451608|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |421590|1494034144|       11|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |976358|1494156949|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |286630|1494218579|       13|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |286630|1494289247|       13|430539_1007|     1|  0|        1.0|(2,[1],[1.0])|
    |771431|1494153867|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |707120|1494220810|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    |530454|1494293746|       13|430548_1007|     1|  0|        0.0|(2,[0],[1.0])|
    +------+----------+---------+-----------+------+---+-----------+-------------+
    only showing top 20 rows


​    

### 处理ad_feature数据


```python
df = spark.read.csv('/data/ad_feature.csv',header = True)
df.show()
```

    +----------+-------+-----------+--------+------+-----+
    |adgroup_id|cate_id|campaign_id|customer| brand|price|
    +----------+-------+-----------+--------+------+-----+
    |     63133|   6406|      83237|       1| 95471|170.0|
    |    313401|   6406|      83237|       1| 87331|199.0|
    |    248909|    392|      83237|       1| 32233| 38.0|
    |    208458|    392|      83237|       1|174374|139.0|
    |    110847|   7211|     135256|       2|145952|32.99|
    |    607788|   6261|     387991|       6|207800|199.0|
    |    375706|   4520|     387991|       6|  NULL| 99.0|
    |     11115|   7213|     139747|       9|186847| 33.0|
    |     24484|   7207|     139744|       9|186847| 19.0|
    |     28589|   5953|     395195|      13|  NULL|428.0|
    |     23236|   5953|     395195|      13|  NULL|368.0|
    |    300556|   5953|     395195|      13|  NULL|639.0|
    |     92560|   5953|     395195|      13|  NULL|368.0|
    |    590965|   4284|      28145|      14|454237|249.0|
    |    529913|   4284|      70206|      14|  NULL|249.0|
    |    546930|   4284|      28145|      14|  NULL|249.0|
    |    639794|   6261|      70206|      14| 37004| 89.9|
    |    335413|   4284|      28145|      14|  NULL|249.0|
    |    794890|   4284|      70206|      14|454237|249.0|
    |    684020|   6261|      70206|      14| 37004| 99.0|
    +----------+-------+-----------+--------+------+-----+
    only showing top 20 rows


​    


```python
from pyspark.sql.types import StructType, StructField, IntegerType, FloatType

# 替换掉NULL字符串，替换掉
df = df.replace("NULL", "-1")

# 打印df结构信息
df.printSchema()   
# 更改df表结构：更改列类型和列名称
ad_feature_df = df.\
    withColumn("adgroup_id", df.adgroup_id.cast(IntegerType())).withColumnRenamed("adgroup_id", "adgroupId").\
    withColumn("cate_id", df.cate_id.cast(IntegerType())).withColumnRenamed("cate_id", "cateId").\
    withColumn("campaign_id", df.campaign_id.cast(IntegerType())).withColumnRenamed("campaign_id", "campaignId").\
    withColumn("customer", df.customer.cast(IntegerType())).withColumnRenamed("customer", "customerId").\
    withColumn("brand", df.brand.cast(IntegerType())).withColumnRenamed("brand", "brandId").\
    withColumn("price", df.price.cast(FloatType()))
ad_feature_df.printSchema()
ad_feature_df.show()
```

    root
     |-- adgroup_id: string (nullable = true)
     |-- cate_id: string (nullable = true)
     |-- campaign_id: string (nullable = true)
     |-- customer: string (nullable = true)
     |-- brand: string (nullable = true)
     |-- price: string (nullable = true)
    
    root
     |-- adgroupId: integer (nullable = true)
     |-- cateId: integer (nullable = true)
     |-- campaignId: integer (nullable = true)
     |-- customerId: integer (nullable = true)
     |-- brandId: integer (nullable = true)
     |-- price: float (nullable = true)
    
    +---------+------+----------+----------+-------+-----+
    |adgroupId|cateId|campaignId|customerId|brandId|price|
    +---------+------+----------+----------+-------+-----+
    |    63133|  6406|     83237|         1|  95471|170.0|
    |   313401|  6406|     83237|         1|  87331|199.0|
    |   248909|   392|     83237|         1|  32233| 38.0|
    |   208458|   392|     83237|         1| 174374|139.0|
    |   110847|  7211|    135256|         2| 145952|32.99|
    |   607788|  6261|    387991|         6| 207800|199.0|
    |   375706|  4520|    387991|         6|     -1| 99.0|
    |    11115|  7213|    139747|         9| 186847| 33.0|
    |    24484|  7207|    139744|         9| 186847| 19.0|
    |    28589|  5953|    395195|        13|     -1|428.0|
    |    23236|  5953|    395195|        13|     -1|368.0|
    |   300556|  5953|    395195|        13|     -1|639.0|
    |    92560|  5953|    395195|        13|     -1|368.0|
    |   590965|  4284|     28145|        14| 454237|249.0|
    |   529913|  4284|     70206|        14|     -1|249.0|
    |   546930|  4284|     28145|        14|     -1|249.0|
    |   639794|  6261|     70206|        14|  37004| 89.9|
    |   335413|  4284|     28145|        14|     -1|249.0|
    |   794890|  4284|     70206|        14| 454237|249.0|
    |   684020|  6261|     70206|        14|  37004| 99.0|
    +---------+------+----------+----------+-------+-----+
    only showing top 20 rows


​    


```python
print("总广告条数：",df.count())   # 数据条数
_1 = ad_feature_df.groupBy("cateId").count().count()
print("cateId数值个数：", _1)
_2 = ad_feature_df.groupBy("campaignId").count().count()
print("campaignId数值个数：", _2)
_3 = ad_feature_df.groupBy("customerId").count().count()
print("customerId数值个数：", _3)
_4 = ad_feature_df.groupBy("brandId").count().count()
print("brandId数值个数：", _4)
```

    总广告条数： 846811
    cateId数值个数： 6769
    campaignId数值个数： 423436
    customerId数值个数： 255875
    brandId数值个数： 99815



```python
ad_feature_df.sort('price').show()
```

    +---------+------+----------+----------+-------+-----+
    |adgroupId|cateId|campaignId|customerId|brandId|price|
    +---------+------+----------+----------+-------+-----+
    |   485749|  9970|    352666|    140520|     -1| 0.01|
    |   174248|  8999|    184344|    196777| 113555| 0.01|
    |    14435|  1136|    135610|     17788|     -1| 0.01|
    |   288172|  9995|    314179|    230326| 399440| 0.01|
    |   518883|  7185|    403318|     58013|     -1| 0.01|
    |    20397| 10539|    410958|     65726|  79971| 0.01|
    |   620285|  7043|    365821|      1960| 188191| 0.01|
    |    89831| 10539|     90141|     83948| 211816| 0.01|
    |     6636|  6703|    392038|     46239| 406713| 0.01|
    |   552638| 10305|    403318|     58013|     -1| 0.01|
    |   692990|  6018|    353223|    223320|     -1| 0.01|
    |   290675|  4824|    315371|    240984|     -1| 0.01|
    |    42055|  9994|     43866|    113068| 123242| 0.01|
    |     2246|  9996|    413653|     60214| 182966| 0.01|
    |     8704|   497|    388492|     13876|     -1| 0.01|
    |   345870|  9995|    179595|    191036|  79971| 0.01|
    |   169988| 10539|    238823|    221154| 211816| 0.01|
    |    67558|  9995|     90141|     83948|     -1| 0.01|
    |    41925|  7032|     85373|    114532|     -1| 0.01|
    |    49911|  7032|    129079|    172334|     -1| 0.01|
    +---------+------+----------+----------+-------+-----+
    only showing top 20 rows


​    


```python
ad_feature_df.sort('price',ascending = False).show()
```

    +---------+------+----------+----------+-------+-----------+
    |adgroupId|cateId|campaignId|customerId|brandId|      price|
    +---------+------+----------+----------+-------+-----------+
    |    31899|   685|    218918|     31239| 278301|      1.0E8|
    |   658722|  1093|    218101|    207754|     -1|      1.0E8|
    |   443295|  1093|     44251|    102509| 300681|      1.0E8|
    |   468220|  1093|    270719|    207754|     -1|      1.0E8|
    |   179746|  1093|    270027|    102509| 405447|      1.0E8|
    |   243384|   685|    218918|     31239| 278301|      1.0E8|
    |   554311|  1093|    266086|    207754|     -1|      1.0E8|
    |   513942|   745|      8401|     86243|     -1|8.8888888E7|
    |   201060|   745|      8401|     86243|     -1|5.5555556E7|
    |   289563|   685|     37665|    120847| 278301|      1.5E7|
    |    35156|   527|    417722|     72273| 278301|      1.0E7|
    |    33756|   527|    416333|     70894|     -1|  9900000.0|
    |   335495|   739|    170121|    148946| 326126|  9600000.0|
    |   218306|   206|    162394|      4339| 221720|  8888888.0|
    |   213567|  7213|    239302|    205612| 406125|  5888888.0|
    |   375920|   527|    217512|    148946| 326126|  4760000.0|
    |   262215|   527|    132721|     11947| 417898|  3980000.0|
    |   152414|   739|    170121|    148946| 326126|  3900000.0|
    |   154623|   739|    170121|    148946| 326126|  3900000.0|
    |   448651|   527|    422260|     41289| 209959|  3800000.0|
    +---------+------+----------+----------+-------+-----------+
    only showing top 20 rows


​    


```python
ad_feature_df.select('price').filter('price>10000').count()
```




    6527




```python
ad_feature_df.select('price').filter('price<1').count()
```




    5762



### 用户特征数据的处理


```python
df = spark.read.csv('/data/user_profile.csv',header = True)
```


```python
df.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+---------------------+
    |userid|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level |
    +------+---------+------------+-----------------+---------+------------+--------------+----------+---------------------+
    |   234|        0|           5|                2|        5|        null|             3|         0|                    3|
    |   523|        5|           2|                2|        2|           1|             3|         1|                    2|
    |   612|        0|           8|                1|        2|           2|             3|         0|                 null|
    |  1670|        0|           4|                2|        4|        null|             1|         0|                 null|
    |  2545|        0|          10|                1|        4|        null|             3|         0|                 null|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                    2|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                    2|
    |  6211|        0|           9|                1|        3|        null|             3|         0|                    2|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                    4|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                    1|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                    2|
    |  9293|        0|           5|                2|        5|        null|             3|         0|                    4|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                    2|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                    2|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                 null|
    | 10812|        0|           4|                2|        4|        null|             2|         0|                 null|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                 null|
    | 10996|        0|           5|                2|        5|        null|             3|         0|                    4|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                    3|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                    4|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+---------------------+
    only showing top 20 rows


​    


```python
from pyspark.sql.types import StructType, StructField, StringType, IntegerType, LongType, FloatType

# 构建表结构schema对象
schema = StructType([
    StructField("userId", IntegerType()),
    StructField("cms_segid", IntegerType()),
    StructField("cms_group_id", IntegerType()),
    StructField("final_gender_code", IntegerType()),
    StructField("age_level", IntegerType()),
    StructField("pvalue_level", IntegerType()),
    StructField("shopping_level", IntegerType()),
    StructField("occupation", IntegerType()),
    StructField("new_user_class_level", IntegerType())
])
# 利用schema从hdfs加载
user_profile_df = spark.read.csv("/data/user_profile.csv", header=True, schema=schema)
user_profile_df.printSchema()
user_profile_df.show()
```

    root
     |-- userId: integer (nullable = true)
     |-- cms_segid: integer (nullable = true)
     |-- cms_group_id: integer (nullable = true)
     |-- final_gender_code: integer (nullable = true)
     |-- age_level: integer (nullable = true)
     |-- pvalue_level: integer (nullable = true)
     |-- shopping_level: integer (nullable = true)
     |-- occupation: integer (nullable = true)
     |-- new_user_class_level: integer (nullable = true)
    
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |   234|        0|           5|                2|        5|        null|             3|         0|                   3|
    |   523|        5|           2|                2|        2|           1|             3|         1|                   2|
    |   612|        0|           8|                1|        2|           2|             3|         0|                null|
    |  1670|        0|           4|                2|        4|        null|             1|         0|                null|
    |  2545|        0|          10|                1|        4|        null|             3|         0|                null|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                   2|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                   2|
    |  6211|        0|           9|                1|        3|        null|             3|         0|                   2|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                   4|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                   1|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                   2|
    |  9293|        0|           5|                2|        5|        null|             3|         0|                   4|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                   2|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                   2|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                null|
    | 10812|        0|           4|                2|        4|        null|             2|         0|                null|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                null|
    | 10996|        0|           5|                2|        5|        null|             3|         0|                   4|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                   3|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                   4|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    only showing top 20 rows


​    


```python
print("分类特征值个数情况: ")
print("cms_segid: ", user_profile_df.groupBy("cms_segid").count().count())
print("cms_group_id: ", user_profile_df.groupBy("cms_group_id").count().count())
print("final_gender_code: ", user_profile_df.groupBy("final_gender_code").count().count())
print("age_level: ", user_profile_df.groupBy("age_level").count().count())
print("shopping_level: ", user_profile_df.groupBy("shopping_level").count().count())
print("occupation: ", user_profile_df.groupBy("occupation").count().count())
```

    分类特征值个数情况: 
    cms_segid:  97
    cms_group_id:  13
    final_gender_code:  2
    age_level:  7
    shopping_level:  3
    occupation:  2



```python
print('含有缺失值的特征情况：')
user_profile_df.groupBy('pvalue_level').count().show()
user_profile_df.groupBy('new_user_class_level').count().show()
```

    含有缺失值的特征情况：
    +------------+------+
    |pvalue_level| count|
    +------------+------+
    |        null|575917|
    |           1|154436|
    |           3| 37759|
    |           2|293656|
    +------------+------+
    
    +--------------------+------+
    |new_user_class_level| count|
    +--------------------+------+
    |                null|344920|
    |                   1| 80548|
    |                   3|173047|
    |                   4|138833|
    |                   2|324420|
    +--------------------+------+


​    


```python
t_count = user_profile_df.count()
```


```python
pl_na_count = t_count-user_profile_df.dropna(subset=['pvalue_level']).count()
```


```python
pl_na_count/t_count
```




    0.542413220213832




```python
nul_na_count = t_count-user_profile_df.dropna(subset=['new_user_class_level']).count()
```


```python
nul_na_count/t_count
```




    0.32485439380354275

####  LabeledPoint左侧为预测值，右侧为特征值列表


```python
#使用MLlib 做预测，数据需要准备成由Labeled Point对象组成的RDD
from pyspark.mllib.regression import LabeledPoint
train_data = user_profile_df.dropna(subset=['pvalue_level']).rdd.map(lambda r:LabeledPoint(r.pvalue_level-1,[r.cms_segid, r.cms_group_id, r.final_gender_code, r.age_level, r.shopping_level, r.occupation]))
```


```python
train_data.take(5)   
#LabeledPoint左侧为预测值，右侧为特征值列表
#在MLlib中，LabeledPoint用于监督学习算法
```




    [LabeledPoint(0.0, [5.0,2.0,2.0,2.0,3.0,1.0]),
     LabeledPoint(1.0, [0.0,8.0,1.0,2.0,3.0,0.0]),
     LabeledPoint(1.0, [49.0,6.0,2.0,6.0,3.0,0.0]),
     LabeledPoint(1.0, [44.0,5.0,2.0,5.0,3.0,0.0]),
     LabeledPoint(0.0, [2.0,1.0,2.0,1.0,3.0,0.0])]

#### 随机森林预测缺失值


```python
from pyspark.mllib.tree import RandomForest
model = RandomForest.trainClassifier(train_data,3,{},5)
#model.predict
```


```python
#取出所有包含缺失值的数据
pl_na_df = user_profile_df.na.fill(-1).where('pvalue_level=-1')
```


```python
pl_na_df.count()
```




    575917




```python
# 定义函数返回特征值
def row(r):
    return r.cms_segid, r.cms_group_id, r.final_gender_code, r.age_level, r.shopping_level, r.occupation
rdd = pl_na_df.rdd.map(row)
```


```python
predicts = model.predict(rdd)
```


```python
predicts.count()
```




    575917




```python
# 利用预测的结果回填原始数据
temp = predicts.map(lambda x:int(x)).collect()
```


```python
pdf = pl_na_df.toPandas()
import numpy as np
pdf['pvalue_level'] = np.array(temp)+1  # 
```


```python
tempDF = spark.createDataFrame(pdf,schema=schema)
```


```python
tempDF.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |   234|        0|           5|                2|        5|           2|             3|         0|                   3|
    |  1670|        0|           4|                2|        4|           2|             1|         0|                  -1|
    |  2545|        0|          10|                1|        4|           2|             3|         0|                  -1|
    |  6211|        0|           9|                1|        3|           2|             3|         0|                   2|
    |  9293|        0|           5|                2|        5|           2|             3|         0|                   4|
    | 10812|        0|           4|                2|        4|           2|             2|         0|                  -1|
    | 10996|        0|           5|                2|        5|           2|             3|         0|                   4|
    | 11602|        0|           5|                2|        5|           2|             3|         0|                   2|
    | 11727|        0|           3|                2|        3|           1|             3|         0|                   1|
    | 12195|        0|          10|                1|        4|           2|             3|         0|                   2|
    | 12620|        0|           4|                2|        4|           2|             2|         0|                  -1|
    | 12873|        0|           5|                2|        5|           2|             3|         0|                   2|
    | 14027|        0|          10|                1|        4|           2|             3|         0|                   3|
    | 14437|        0|           5|                2|        5|           2|             3|         0|                  -1|
    | 14574|        0|           1|                2|        1|           1|             2|         0|                  -1|
    | 14985|        0|          11|                1|        5|           2|             2|         0|                  -1|
    | 15525|        0|           3|                2|        3|           1|             3|         0|                   1|
    | 17025|        0|           5|                2|        5|           2|             3|         0|                  -1|
    | 17097|        0|           4|                2|        4|           2|             2|         0|                  -1|
    | 18799|        0|           5|                2|        5|           2|             3|         0|                   4|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    only showing top 20 rows


​    


```python
#把缺失的和正常的数据拼接到一起
new_user_profile_df = user_profile_df.dropna(subset=['pvalue_level']).unionAll(tempDF)
```


```python
new_user_profile_df.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |   523|        5|           2|                2|        2|           1|             3|         1|                   2|
    |   612|        0|           8|                1|        2|           2|             3|         0|                null|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                   2|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                   2|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                   4|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                   1|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                   2|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                   2|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                   2|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                null|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                null|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                   3|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                   4|
    | 11739|       20|           3|                2|        3|           2|             3|         0|                   4|
    | 12549|       33|           4|                2|        4|           2|             3|         0|                   2|
    | 15155|       36|           5|                2|        5|           2|             1|         0|                null|
    | 15347|       20|           3|                2|        3|           2|             3|         0|                   3|
    | 15455|        8|           2|                2|        2|           2|             3|         0|                   3|
    | 15783|        0|           4|                2|        4|           2|             3|         0|                null|
    | 16749|        5|           2|                2|        2|           1|             3|         1|                   4|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    only showing top 20 rows


​    


```python
user_profile_df.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |   234|        0|           5|                2|        5|        null|             3|         0|                   3|
    |   523|        5|           2|                2|        2|           1|             3|         1|                   2|
    |   612|        0|           8|                1|        2|           2|             3|         0|                null|
    |  1670|        0|           4|                2|        4|        null|             1|         0|                null|
    |  2545|        0|          10|                1|        4|        null|             3|         0|                null|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                   2|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                   2|
    |  6211|        0|           9|                1|        3|        null|             3|         0|                   2|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                   4|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                   1|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                   2|
    |  9293|        0|           5|                2|        5|        null|             3|         0|                   4|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                   2|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                   2|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                null|
    | 10812|        0|           4|                2|        4|        null|             2|         0|                null|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                null|
    | 10996|        0|           5|                2|        5|        null|             3|         0|                   4|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                   3|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                   4|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    only showing top 20 rows


​    

### 缺失值处理 把null作为一个单独的分类进行one hot处理


```python
from pyspark.sql.types import StringType
user_profile_df = user_profile_df.na.fill(-1)
user_profile_df.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    |   234|        0|           5|                2|        5|          -1|             3|         0|                   3|
    |   523|        5|           2|                2|        2|           1|             3|         1|                   2|
    |   612|        0|           8|                1|        2|           2|             3|         0|                  -1|
    |  1670|        0|           4|                2|        4|          -1|             1|         0|                  -1|
    |  2545|        0|          10|                1|        4|          -1|             3|         0|                  -1|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                   2|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                   2|
    |  6211|        0|           9|                1|        3|          -1|             3|         0|                   2|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                   4|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                   1|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                   2|
    |  9293|        0|           5|                2|        5|          -1|             3|         0|                   4|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                   2|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                   2|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                  -1|
    | 10812|        0|           4|                2|        4|          -1|             2|         0|                  -1|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                  -1|
    | 10996|        0|           5|                2|        5|          -1|             3|         0|                   4|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                   3|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                   4|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+
    only showing top 20 rows


​    


```python
#在进行Onehot处理时 stringindexer要求数据是字符串类型的
user_profile_df = user_profile_df.withColumn('pvalue_level',user_profile_df.pvalue_level.cast(StringType())).withColumn('new_user_class_level',user_profile_df.new_user_class_level.cast(StringType()))
```


```python
user_profile_df.printSchema()
```

    root
     |-- userId: integer (nullable = true)
     |-- cms_segid: integer (nullable = true)
     |-- cms_group_id: integer (nullable = true)
     |-- final_gender_code: integer (nullable = true)
     |-- age_level: integer (nullable = true)
     |-- pvalue_level: string (nullable = true)
     |-- shopping_level: integer (nullable = true)
     |-- occupation: integer (nullable = true)
     |-- new_user_class_level: string (nullable = true)


​    


```python
stringIndexer1 = StringIndexer(inputCol = 'pvalue_level',outputCol = 'pl_onehot_feature')
encoder2 = OneHotEncoder(dropLast = False,inputCol = 'pl_onehot_feature',outputCol = 'pl_onehot_value')
pipeline1 = Pipeline(stages = [stringIndexer1,encoder2])
temp_model = pipeline1.fit(user_profile_df)
user_profile_df2 = temp_model.transform(user_profile_df)
```


```python
user_profile_df2.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|pl_onehot_feature|pl_onehot_value|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+
    |   234|        0|           5|                2|        5|          -1|             3|         0|                   3|              0.0|  (4,[0],[1.0])|
    |   523|        5|           2|                2|        2|           1|             3|         1|                   2|              2.0|  (4,[2],[1.0])|
    |   612|        0|           8|                1|        2|           2|             3|         0|                  -1|              1.0|  (4,[1],[1.0])|
    |  1670|        0|           4|                2|        4|          -1|             1|         0|                  -1|              0.0|  (4,[0],[1.0])|
    |  2545|        0|          10|                1|        4|          -1|             3|         0|                  -1|              0.0|  (4,[0],[1.0])|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|
    |  6211|        0|           9|                1|        3|          -1|             3|         0|                   2|              0.0|  (4,[0],[1.0])|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                   4|              2.0|  (4,[2],[1.0])|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                   2|              1.0|  (4,[1],[1.0])|
    |  9293|        0|           5|                2|        5|          -1|             3|         0|                   4|              0.0|  (4,[0],[1.0])|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                   2|              1.0|  (4,[1],[1.0])|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                  -1|              1.0|  (4,[1],[1.0])|
    | 10812|        0|           4|                2|        4|          -1|             2|         0|                  -1|              0.0|  (4,[0],[1.0])|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                  -1|              1.0|  (4,[1],[1.0])|
    | 10996|        0|           5|                2|        5|          -1|             3|         0|                   4|              0.0|  (4,[0],[1.0])|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                   3|              2.0|  (4,[2],[1.0])|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                   4|              2.0|  (4,[2],[1.0])|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+
    only showing top 20 rows


​    


```python
stringindexer = StringIndexer(inputCol='new_user_class_level', outputCol='nucl_onehot_feature')
encoder = OneHotEncoder(dropLast=False, inputCol='nucl_onehot_feature', outputCol='nucl_onehot_value')
pipeline = Pipeline(stages=[stringindexer, encoder])
pipeline_fit = pipeline.fit(user_profile_df2)
user_profile_df3 = pipeline_fit.transform(user_profile_df2)
user_profile_df3.show()
```

    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+-------------------+-----------------+
    |userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|pl_onehot_feature|pl_onehot_value|nucl_onehot_feature|nucl_onehot_value|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+-------------------+-----------------+
    |   234|        0|           5|                2|        5|          -1|             3|         0|                   3|              0.0|  (4,[0],[1.0])|                2.0|    (5,[2],[1.0])|
    |   523|        5|           2|                2|        2|           1|             3|         1|                   2|              2.0|  (4,[2],[1.0])|                1.0|    (5,[1],[1.0])|
    |   612|        0|           8|                1|        2|           2|             3|         0|                  -1|              1.0|  (4,[1],[1.0])|                0.0|    (5,[0],[1.0])|
    |  1670|        0|           4|                2|        4|          -1|             1|         0|                  -1|              0.0|  (4,[0],[1.0])|                0.0|    (5,[0],[1.0])|
    |  2545|        0|          10|                1|        4|          -1|             3|         0|                  -1|              0.0|  (4,[0],[1.0])|                0.0|    (5,[0],[1.0])|
    |  3644|       49|           6|                2|        6|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |  5777|       44|           5|                2|        5|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |  6211|        0|           9|                1|        3|          -1|             3|         0|                   2|              0.0|  (4,[0],[1.0])|                1.0|    (5,[1],[1.0])|
    |  6355|        2|           1|                2|        1|           1|             3|         0|                   4|              2.0|  (4,[2],[1.0])|                3.0|    (5,[3],[1.0])|
    |  6823|       43|           5|                2|        5|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    |  6972|        5|           2|                2|        2|           2|             3|         1|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |  9293|        0|           5|                2|        5|          -1|             3|         0|                   4|              0.0|  (4,[0],[1.0])|                3.0|    (5,[3],[1.0])|
    |  9510|       55|           8|                1|        2|           2|             2|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    | 10122|       33|           4|                2|        4|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    | 10549|        0|           4|                2|        4|           2|             3|         0|                  -1|              1.0|  (4,[1],[1.0])|                0.0|    (5,[0],[1.0])|
    | 10812|        0|           4|                2|        4|          -1|             2|         0|                  -1|              0.0|  (4,[0],[1.0])|                0.0|    (5,[0],[1.0])|
    | 10912|        0|           4|                2|        4|           2|             3|         0|                  -1|              1.0|  (4,[1],[1.0])|                0.0|    (5,[0],[1.0])|
    | 10996|        0|           5|                2|        5|          -1|             3|         0|                   4|              0.0|  (4,[0],[1.0])|                3.0|    (5,[3],[1.0])|
    | 11256|        8|           2|                2|        2|           1|             3|         0|                   3|              2.0|  (4,[2],[1.0])|                2.0|    (5,[2],[1.0])|
    | 11310|       31|           4|                2|        4|           1|             3|         0|                   4|              2.0|  (4,[2],[1.0])|                3.0|    (5,[3],[1.0])|
    +------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+-------------------+-----------------+
    only showing top 20 rows


​    

- 数据合并 把raw_sample ad_feature user_profile合并到一起


```python
condition = [new_df.adgroupId == ad_feature_df.adgroupId]
_ = new_df.join(ad_feature_df,condition,'outer')
```


```python
#_.show()
```

    +-------+----------+---------+-----------+------+---+---------+------+----------+----------+-------+-----+
    | userId| timestamp|adgroupId|        pid|nonclk|clk|adgroupId|cateId|campaignId|customerId|brandId|price|
    +-------+----------+---------+-----------+------+---+---------+------+----------+----------+-------+-----+
    | 952071|1494394228|      148|430548_1007|     0|  1|      148| 11005|    395681|     50113| 390701| 26.0|
    | 574551|1494306713|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 130695|1494629548|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 130695|1494678574|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 807606|1494396192|      148|430548_1007|     0|  1|      148| 11005|    395681|     50113| 390701| 26.0|
    | 130695|1494458178|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 807606|1494670534|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 883741|1494303825|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 167485|1494073100|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 951221|1494292456|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 679661|1494601574|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 896203|1494578717|      148|430539_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 752772|1494545545|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 844764|1494242462|      148|430548_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 133877|1494400466|      148|430539_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    |1040395|1494306282|      148|430539_1007|     0|  1|      148| 11005|    395681|     50113| 390701| 26.0|
    | 532269|1494578793|      148|430539_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    |1040395|1494374101|      148|430539_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 532269|1494387397|      148|430539_1007|     1|  0|      148| 11005|    395681|     50113| 390701| 26.0|
    | 715390|1494233581|      148|430539_1007|     0|  1|      148| 11005|    395681|     50113| 390701| 26.0|
    +-------+----------+---------+-----------+------+---+---------+------+----------+----------+-------+-----+
    only showing top 20 rows


​    


```python
condition2 = [_.userId == user_profile_df3.userId]
datasets = _.join(user_profile_df3,condition2,'outer')
```


```python
datasets.show()
```

    +------+----------+---------+-----------+------+---+---------+------+----------+----------+-------+------+------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+-------------------+-----------------+
    |userId| timestamp|adgroupId|        pid|nonclk|clk|adgroupId|cateId|campaignId|customerId|brandId| price|userId|cms_segid|cms_group_id|final_gender_code|age_level|pvalue_level|shopping_level|occupation|new_user_class_level|pl_onehot_feature|pl_onehot_value|nucl_onehot_feature|nucl_onehot_value|
    +------+----------+---------+-----------+------+---+---------+------+----------+----------+-------+------+------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+-------------------+-----------------+
    |   148|1494261938|    33926|430539_1007|     1|  0|    33926|  7289|    394521|     48886|     -1| 108.0|   148|        0|          11|                1|        5|          -1|             3|         0|                   2|              0.0|  (4,[0],[1.0])|                1.0|    (5,[1],[1.0])|
    |   148|1494261938|   493476|430539_1007|     1|  0|   493476|  6152|    203218|    113014| 157916|1880.0|   148|        0|          11|                1|        5|          -1|             3|         0|                   2|              0.0|  (4,[0],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494553913|   385161|430539_1007|     0|  1|   385161|  4541|      4169|     64359|  25539|1990.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494553913|   200185|430539_1007|     1|  0|   200185|  4307|    119566|    155708|  91783|2200.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494436784|   661793|430539_1007|     1|  0|   661793|  4307|    257818|     43866| 118978|5649.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494677292|   649692|430539_1007|     1|  0|   649692|  4282|    114486|     28529|  82527| 176.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494677292|   839598|430539_1007|     1|  0|   839598|  4284|    420189|     28583|  43811| 698.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494416583|   609998|430539_1007|     1|  0|   609998|  4307|     62043|    100545| 336263|2760.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494553913|   358282|430539_1007|     1|  0|   358282|  7635|    111414|     73974| 110613|2360.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494436784|   659407|430539_1007|     1|  0|   659407|  6736|     35235|     84428| 231945| 150.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494416583|   704440|430539_1007|     1|  0|   704440|  7635|    373364|    232349| 237471| 697.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494677292|   704440|430539_1007|     1|  0|   704440|  7635|    373364|    232349| 237471| 697.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494416583|   629664|430539_1007|     1|  0|   629664|  4307|    411691|     64746| 203914|9999.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   463|1494436784|   175991|430539_1007|     1|  0|   175991| 10579|    267645|     47289| 200987|  48.0|   463|       19|           3|                2|        3|           2|             3|         0|                   2|              1.0|  (4,[1],[1.0])|                1.0|    (5,[1],[1.0])|
    |   471|1494395405|   761609|430539_1007|     1|  0|   761609|  6261|     12462|     81934| 355463| 329.0|   471|       18|           3|                2|        3|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    |   471|1494374944|   670230|430539_1007|     1|  0|   670230|  4281|    208551|     15140|     -1| 99.98|   471|       18|           3|                2|        3|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    |   471|1494660338|   821482|430539_1007|     1|  0|   821482|  6261|    208956|     29685| 119353| 568.0|   471|       18|           3|                2|        3|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    |   471|1494395405|   526229|430539_1007|     1|  0|   526229|  6261|    148252|     43337| 163428| 168.0|   471|       18|           3|                2|        3|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    |   471|1494402522|   651834|430539_1007|     1|  0|   651834|  6261|    341921|    138833| 115088| 258.0|   471|       18|           3|                2|        3|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    |   471|1494684007|   760006|430539_1007|     1|  0|   760006|  6261|    374933|    134828| 292587| 247.0|   471|       18|           3|                2|        3|           2|             3|         0|                   1|              1.0|  (4,[1],[1.0])|                4.0|    (5,[4],[1.0])|
    +------+----------+---------+-----------+------+---+---------+------+----------+----------+-------+------+------+---------+------------+-----------------+---------+------------+--------------+----------+--------------------+-----------------+---------------+-------------------+-----------------+
    only showing top 20 rows


​    


```python
useful_cols = [
    # 
    # 时间字段，划分训练集和测试集
    "timestamp",
    # label目标值字段
    "clk",  
    # 特征值字段
    "pid_value",       # 资源位的特征向量
    "price",    # 广告价格
    "cms_segid",    # 用户微群ID
    "cms_group_id",    # 用户组ID
    "final_gender_code",    # 用户性别特征，[1,2]
    "age_level",    # 年龄等级，1-
    "shopping_level",
    "occupation",
    "pl_onehot_value",
    "nucl_onehot_value"
]
# 筛选指定字段数据，构建新的数据集
datasets_1 = datasets.select(*useful_cols)
# 由于前面使用的是outer方式合并的数据，产生了部分空值数据，这里必须先剔除掉
datasets_1 = datasets_1.dropna()
```


```python
datasets_1.show()
```

    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+
    | timestamp|clk|    pid_value| price|cms_segid|cms_group_id|final_gender_code|age_level|shopping_level|occupation|pl_onehot_value|nucl_onehot_value|
    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+
    |1494261938|  0|(2,[1],[1.0])| 108.0|        0|          11|                1|        5|             3|         0|  (4,[0],[1.0])|    (5,[1],[1.0])|
    |1494261938|  0|(2,[1],[1.0])|1880.0|        0|          11|                1|        5|             3|         0|  (4,[0],[1.0])|    (5,[1],[1.0])|
    |1494553913|  1|(2,[1],[1.0])|1990.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494553913|  0|(2,[1],[1.0])|2200.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494436784|  0|(2,[1],[1.0])|5649.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494677292|  0|(2,[1],[1.0])| 176.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494677292|  0|(2,[1],[1.0])| 698.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494416583|  0|(2,[1],[1.0])|2760.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494553913|  0|(2,[1],[1.0])|2360.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494436784|  0|(2,[1],[1.0])| 150.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494416583|  0|(2,[1],[1.0])| 697.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494677292|  0|(2,[1],[1.0])| 697.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494416583|  0|(2,[1],[1.0])|9999.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494436784|  0|(2,[1],[1.0])|  48.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|
    |1494395405|  0|(2,[1],[1.0])| 329.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|
    |1494374944|  0|(2,[1],[1.0])| 99.98|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|
    |1494660338|  0|(2,[1],[1.0])| 568.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|
    |1494395405|  0|(2,[1],[1.0])| 168.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|
    |1494402522|  0|(2,[1],[1.0])| 258.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|
    |1494684007|  0|(2,[1],[1.0])| 247.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|
    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+
    only showing top 20 rows


​    

### 利用数据去训练逻辑回归的模型
- 把数据准备好  创建一个DataFrame 目标值是一列，所有的特征都放到一列中


```python
from pyspark.ml.feature import VectorAssembler
datasets_1 = VectorAssembler().setInputCols(useful_cols[2:]).setOutputCol('features').transform(datasets_1)
```


```python
datasets_1.show()
```

    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+--------------------+
    | timestamp|clk|    pid_value| price|cms_segid|cms_group_id|final_gender_code|age_level|shopping_level|occupation|pl_onehot_value|nucl_onehot_value|            features|
    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+--------------------+
    |1494261938|  0|(2,[1],[1.0])| 108.0|        0|          11|                1|        5|             3|         0|  (4,[0],[1.0])|    (5,[1],[1.0])|(18,[1,2,4,5,6,7,...|
    |1494261938|  0|(2,[1],[1.0])|1880.0|        0|          11|                1|        5|             3|         0|  (4,[0],[1.0])|    (5,[1],[1.0])|(18,[1,2,4,5,6,7,...|
    |1494553913|  1|(2,[1],[1.0])|1990.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494553913|  0|(2,[1],[1.0])|2200.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494436784|  0|(2,[1],[1.0])|5649.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494677292|  0|(2,[1],[1.0])| 176.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494677292|  0|(2,[1],[1.0])| 698.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494416583|  0|(2,[1],[1.0])|2760.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494553913|  0|(2,[1],[1.0])|2360.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494436784|  0|(2,[1],[1.0])| 150.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494416583|  0|(2,[1],[1.0])| 697.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494677292|  0|(2,[1],[1.0])| 697.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494416583|  0|(2,[1],[1.0])|9999.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494436784|  0|(2,[1],[1.0])|  48.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494395405|  0|(2,[1],[1.0])| 329.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494374944|  0|(2,[1],[1.0])| 99.98|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494660338|  0|(2,[1],[1.0])| 568.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494395405|  0|(2,[1],[1.0])| 168.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494402522|  0|(2,[1],[1.0])| 258.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|
    |1494684007|  0|(2,[1],[1.0])| 247.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|
    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+--------------------+
    only showing top 20 rows


​    


```python
#VectorAssemble 把特征值放到一列里面
# 训练集测试集的划分  利用时间戳这一列
datasets_1.sort('timestamp',ascending = False).show()
```

    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+
    | timestamp|clk|    pid_value| price|cms_segid|cms_group_id|final_gender_code|age_level|shopping_level|occupation|pl_onehot_value|nucl_onehot_value|
    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+
    |1494691186|  0|(2,[0],[1.0])|1460.0|       20|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[3],[1.0])|
    |1494691186|  0|(2,[0],[1.0])| 350.0|        0|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[0],[1.0])|
    |1494691184|  0|(2,[0],[1.0])|  90.0|       54|           8|                1|        2|             3|         1|  (4,[2],[1.0])|    (5,[3],[1.0])|
    |1494691184|  0|(2,[0],[1.0])| 499.0|        0|           3|                2|        3|             3|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|
    |1494691184|  0|(2,[0],[1.0])|  58.0|        0|           3|                2|        3|             3|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|
    |1494691184|  0|(2,[0],[1.0])|  89.0|       54|           8|                1|        2|             3|         1|  (4,[2],[1.0])|    (5,[3],[1.0])|
    |1494691184|  0|(2,[0],[1.0])| 168.0|       54|           8|                1|        2|             3|         1|  (4,[2],[1.0])|    (5,[3],[1.0])|
    |1494691183|  0|(2,[0],[1.0])| 388.0|        0|           3|                2|        3|             3|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|
    |1494691183|  0|(2,[1],[1.0])|  99.0|        0|          10|                1|        4|             3|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|
    |1494691183|  0|(2,[0],[1.0])|  99.0|        0|           3|                2|        3|             3|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|
    |1494691183|  0|(2,[1],[1.0])|  90.0|        0|          10|                1|        4|             3|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|
    |1494691180|  0|(2,[0],[1.0])|  72.7|        5|           2|                2|        2|             3|         1|  (4,[1],[1.0])|    (5,[4],[1.0])|
    |1494691179|  0|(2,[0],[1.0])| 198.0|        0|           3|                2|        3|             3|         0|  (4,[0],[1.0])|    (5,[3],[1.0])|
    |1494691179|  0|(2,[0],[1.0])| 298.0|       34|           4|                2|        4|             3|         0|  (4,[1],[1.0])|    (5,[3],[1.0])|
    |1494691179|  0|(2,[0],[1.0])| 229.0|        0|          10|                1|        4|             3|         0|  (4,[1],[1.0])|    (5,[0],[1.0])|
    |1494691179|  0|(2,[1],[1.0])| 158.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[3],[1.0])|
    |1494691179|  0|(2,[0],[1.0])| 199.0|        0|          10|                1|        4|             3|         0|  (4,[1],[1.0])|    (5,[0],[1.0])|
    |1494691179|  0|(2,[0],[1.0])| 195.0|       34|           4|                2|        4|             3|         0|  (4,[1],[1.0])|    (5,[3],[1.0])|
    |1494691179|  0|(2,[0],[1.0])| 113.0|        0|           3|                2|        3|             3|         0|  (4,[0],[1.0])|    (5,[3],[1.0])|
    |1494691179|  0|(2,[0],[1.0])|  98.0|       34|           4|                2|        4|             3|         0|  (4,[1],[1.0])|    (5,[3],[1.0])|
    +----------+---+-------------+------+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+
    only showing top 20 rows


​    


```python
train_datasets_1 = datasets_1.filter(datasets_1.timestamp<=(1494691186-24*60*60))
test_datasets_1 = datasets_1.filter(datasets_1.timestamp>(1494691186-24*60*60))
```


```python
test_datasets_1.count()
```


```python
train_datasets_1.count()
```




    21929913




```python
#创建逻辑回归分类器对象 训练模型
from pyspark.ml.classification import LogisticRegression
lr = LogisticRegression()
#设置目标值和特征值字段
model = lr.setLabelCol('clk').setFeaturesCol('features').fit(train_datasets_1)
```


    ---------------------------------------------------------------------------
    
    KeyboardInterrupt                         Traceback (most recent call last)
    
    <ipython-input-141-4906258c6cc5> in <module>
          3 lr = LogisticRegression()
          4 #设置目标值和特征值字段
    ----> 5 model = lr.setLabelCol('clk').setFeaturesCol('features').fit(train_datasets_1)


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/ml/base.py in fit(self, dataset, params)
         62                 return self.copy(params)._fit(dataset)
         63             else:
    ---> 64                 return self._fit(dataset)
         65         else:
         66             raise ValueError("Params must be either a param map or a list/tuple of param maps, "


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/ml/wrapper.py in _fit(self, dataset)
        263 
        264     def _fit(self, dataset):
    --> 265         java_model = self._fit_java(dataset)
        266         return self._create_model(java_model)
        267 


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/ml/wrapper.py in _fit_java(self, dataset)
        260         """
        261         self._transfer_params_to_java()
    --> 262         return self._java_obj.fit(dataset._jdf)
        263 
        264     def _fit(self, dataset):


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in __call__(self, *args)
       1253             proto.END_COMMAND_PART
       1254 
    -> 1255         answer = self.gateway_client.send_command(command)
       1256         return_value = get_return_value(
       1257             answer, self.gateway_client, self.target_id, self.name)


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in send_command(self, command, retry, binary)
        983         connection = self._get_connection()
        984         try:
    --> 985             response = connection.send_command(command)
        986             if binary:
        987                 return response, self._create_connection_guard(connection)


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in send_command(self, command)
       1150 
       1151         try:
    -> 1152             answer = smart_decode(self.stream.readline()[:-1])
       1153             logger.debug("Answer received: {0}".format(answer))
       1154             if answer.startswith(proto.RETURN_MESSAGE):


    /miniconda2/envs/py365/lib/python3.6/socket.py in readinto(self, b)
        584         while True:
        585             try:
    --> 586                 return self._sock.recv_into(b)
        587             except timeout:
        588                 self._timeout_occurred = True


    KeyboardInterrupt: 



```python
from pyspark.ml.classification import LogisticRegressionModel
model = LogisticRegressionModel.load("hdfs://192.168.2.137:9000/models/CTRModel_Normal.obj")
```


```python
result_1 = model.transform(test_datasets_1)
```


```python
result_1.show()
```

    +----------+---+-------------+-----+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+--------------------+--------------------+--------------------+----------+
    | timestamp|clk|    pid_value|price|cms_segid|cms_group_id|final_gender_code|age_level|shopping_level|occupation|pl_onehot_value|nucl_onehot_value|            features|       rawPrediction|         probability|prediction|
    +----------+---+-------------+-----+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+--------------------+--------------------+--------------------+----------+
    |1494677292|  0|(2,[1],[1.0])|176.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|[2.85514380089853...|[0.94558396414253...|       0.0|
    |1494677292|  0|(2,[1],[1.0])|698.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|[2.85513904442684...|[0.94558371939809...|       0.0|
    |1494677292|  0|(2,[1],[1.0])|697.0|       19|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[1],[1.0])|(18,[1,2,3,4,5,6,...|[2.85513905353886...|[0.94558371986695...|       0.0|
    |1494684007|  0|(2,[1],[1.0])|109.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|[2.87485982015038...|[0.94658958346689...|       0.0|
    |1494660338|  0|(2,[1],[1.0])|137.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|[2.87485956501397...|[0.94658957056777...|       0.0|
    |1494660338|  1|(2,[1],[1.0])|239.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|[2.87485863558847...|[0.94658952357808...|       0.0|
    |1494684007|  0|(2,[1],[1.0])|118.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|[2.87485973814225...|[0.94658957932074...|       0.0|
    |1494684007|  0|(2,[1],[1.0])|247.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|[2.87485856269235...|[0.94658951989261...|       0.0|
    |1494660338|  0|(2,[1],[1.0])|568.0|       18|           3|                2|        3|             3|         0|  (4,[1],[1.0])|    (5,[4],[1.0])|(18,[1,2,3,4,5,6,...|[2.87485563773562...|[0.94658937201304...|       0.0|
    |1494680742|  0|(2,[1],[1.0])|599.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[2],[1.0])|(18,[1,2,4,5,6,7,...|[2.85913703414869...|[0.94578907046101...|       0.0|
    |1494680742|  0|(2,[1],[1.0])|336.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[2],[1.0])|(18,[1,2,4,5,6,7,...|[2.85913943060856...|[0.94578919333242...|       0.0|
    |1494646389|  0|(2,[1],[1.0])|509.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[2],[1.0])|(18,[1,2,4,5,6,7,...|[2.85913785423001...|[0.94578911250829...|       0.0|
    |1494646389|  0|(2,[1],[1.0])| 76.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[2],[1.0])|(18,[1,2,4,5,6,7,...|[2.85914179973239...|[0.94578931480200...|       0.0|
    |1494646389|  0|(2,[1],[1.0])|368.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[2],[1.0])|(18,[1,2,4,5,6,7,...|[2.85913913902409...|[0.94578917838230...|       0.0|
    |1494680742|  0|(2,[1],[1.0])|395.0|        0|           4|                2|        4|             3|         0|  (4,[0],[1.0])|    (5,[2],[1.0])|(18,[1,2,4,5,6,7,...|[2.85913889299969...|[0.94578916576814...|       0.0|
    |1494653738|  0|(2,[0],[1.0])| 49.9|        0|           1|                2|        1|             2|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|(18,[0,2,4,5,6,7,...|[2.87155175369309...|[0.94642208779335...|       0.0|
    |1494653738|  1|(2,[0],[1.0])|110.0|        0|           1|                2|        1|             2|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|(18,[0,2,4,5,6,7,...|[2.87155120606102...|[0.94642206002439...|       0.0|
    |1494653738|  0|(2,[0],[1.0])|168.0|        0|           1|                2|        1|             2|         0|  (4,[0],[1.0])|    (5,[0],[1.0])|(18,[0,2,4,5,6,7,...|[2.87155067756417...|[0.94642203322571...|       0.0|
    |1494682333|  0|(2,[1],[1.0])|498.0|        0|           4|                2|        4|             3|         0|  (4,[1],[1.0])|    (5,[0],[1.0])|(18,[1,2,4,5,6,7,...|[2.82641400071363...|[0.94408660879942...|       0.0|
    |1494638898|  0|(2,[1],[1.0])|102.0|        0|           4|                2|        4|             3|         0|  (4,[1],[1.0])|    (5,[0],[1.0])|(18,[1,2,4,5,6,7,...|[2.82641760907147...|[0.94408679927380...|       0.0|
    +----------+---+-------------+-----+---------+------------+-----------------+---------+--------------+----------+---------------+-----------------+--------------------+--------------------+--------------------+----------+
    only showing top 20 rows


​    


```python
result_1.select("clk", "price", "probability", "prediction").sort("probability").show(100)
```


```python
### 离线数据缓存处理
```


```python
#找到类别和广告的对应关系
_ = ad_feature_df.select('adgroupId','cateId')
```


```python
pdf = _.toPandas()
```


```python
pdf
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
    
    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>adgroupId</th>
      <th>cateId</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63133</td>
      <td>6406</td>
    </tr>
    <tr>
      <th>1</th>
      <td>313401</td>
      <td>6406</td>
    </tr>
    <tr>
      <th>2</th>
      <td>248909</td>
      <td>392</td>
    </tr>
    <tr>
      <th>3</th>
      <td>208458</td>
      <td>392</td>
    </tr>
    <tr>
      <th>4</th>
      <td>110847</td>
      <td>7211</td>
    </tr>
    <tr>
      <th>5</th>
      <td>607788</td>
      <td>6261</td>
    </tr>
    <tr>
      <th>6</th>
      <td>375706</td>
      <td>4520</td>
    </tr>
    <tr>
      <th>7</th>
      <td>11115</td>
      <td>7213</td>
    </tr>
    <tr>
      <th>8</th>
      <td>24484</td>
      <td>7207</td>
    </tr>
    <tr>
      <th>9</th>
      <td>28589</td>
      <td>5953</td>
    </tr>
    <tr>
      <th>10</th>
      <td>23236</td>
      <td>5953</td>
    </tr>
    <tr>
      <th>11</th>
      <td>300556</td>
      <td>5953</td>
    </tr>
    <tr>
      <th>12</th>
      <td>92560</td>
      <td>5953</td>
    </tr>
    <tr>
      <th>13</th>
      <td>590965</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>14</th>
      <td>529913</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>15</th>
      <td>546930</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>16</th>
      <td>639794</td>
      <td>6261</td>
    </tr>
    <tr>
      <th>17</th>
      <td>335413</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>18</th>
      <td>794890</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>19</th>
      <td>684020</td>
      <td>6261</td>
    </tr>
    <tr>
      <th>20</th>
      <td>500333</td>
      <td>5515</td>
    </tr>
    <tr>
      <th>21</th>
      <td>479319</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>22</th>
      <td>372438</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>23</th>
      <td>382843</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>24</th>
      <td>379665</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>25</th>
      <td>715831</td>
      <td>4280</td>
    </tr>
    <tr>
      <th>26</th>
      <td>296360</td>
      <td>5515</td>
    </tr>
    <tr>
      <th>27</th>
      <td>419844</td>
      <td>5515</td>
    </tr>
    <tr>
      <th>28</th>
      <td>279841</td>
      <td>917</td>
    </tr>
    <tr>
      <th>29</th>
      <td>74914</td>
      <td>8863</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>846781</th>
      <td>799255</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846782</th>
      <td>732114</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846783</th>
      <td>732115</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846784</th>
      <td>813947</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846785</th>
      <td>799169</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846786</th>
      <td>799254</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846787</th>
      <td>790628</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846788</th>
      <td>799253</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846789</th>
      <td>763037</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846790</th>
      <td>762967</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846791</th>
      <td>813999</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846792</th>
      <td>806024</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846793</th>
      <td>790623</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846794</th>
      <td>793325</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846795</th>
      <td>732419</td>
      <td>1244</td>
    </tr>
    <tr>
      <th>846796</th>
      <td>829443</td>
      <td>6261</td>
    </tr>
    <tr>
      <th>846797</th>
      <td>828754</td>
      <td>12411</td>
    </tr>
    <tr>
      <th>846798</th>
      <td>837778</td>
      <td>6432</td>
    </tr>
    <tr>
      <th>846799</th>
      <td>833539</td>
      <td>6432</td>
    </tr>
    <tr>
      <th>846800</th>
      <td>777764</td>
      <td>5977</td>
    </tr>
    <tr>
      <th>846801</th>
      <td>841089</td>
      <td>5271</td>
    </tr>
    <tr>
      <th>846802</th>
      <td>828175</td>
      <td>8116</td>
    </tr>
    <tr>
      <th>846803</th>
      <td>831181</td>
      <td>7600</td>
    </tr>
    <tr>
      <th>846804</th>
      <td>762452</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>846805</th>
      <td>762200</td>
      <td>4284</td>
    </tr>
    <tr>
      <th>846806</th>
      <td>824255</td>
      <td>4526</td>
    </tr>
    <tr>
      <th>846807</th>
      <td>790170</td>
      <td>4280</td>
    </tr>
    <tr>
      <th>846808</th>
      <td>845286</td>
      <td>6261</td>
    </tr>
    <tr>
      <th>846809</th>
      <td>824732</td>
      <td>4520</td>
    </tr>
    <tr>
      <th>846810</th>
      <td>845337</td>
      <td>11156</td>
    </tr>
  </tbody>
</table>
<p>846811 rows × 2 columns</p>
</div>




```python
pdf.where(pdf.cateId ==11156).dropna().adgroupId
```




    313       138953.0
    314       467512.0
    1661      140008.0
    1666      238772.0
    1669      237471.0
    1670      238761.0
    1671        9933.0
    4095       53437.0
    7540       39952.0
    7541      177307.0
    7542       85647.0
    8692       82370.0
    10125     650941.0
    11395     189810.0
    15450     415875.0
    18390     131934.0
    18412     422911.0
    18415     683715.0
    21001      13858.0
    23945     102299.0
    29187     348378.0
    29188     198096.0
    30675      85423.0
    35256     331234.0
    37993      60736.0
    38053     749642.0
    39503     525090.0
    39504     514192.0
    43756     334249.0
    45583       7306.0
                ...   
    825011    447492.0
    826573    333855.0
    826574    334026.0
    826593    339134.0
    826594    374667.0
    828413    187501.0
    830215    729926.0
    830319    251428.0
    831035    359758.0
    831347    269973.0
    832404    494080.0
    832445    507119.0
    832472    481616.0
    832473    494730.0
    832474    494193.0
    832494    481589.0
    832719    268994.0
    832720    214094.0
    832721    236157.0
    835127    526529.0
    836797    762730.0
    837623    484455.0
    840015    401092.0
    841726    313419.0
    842989    340735.0
    843455    348435.0
    843456    352273.0
    846728    818681.0
    846729    838953.0
    846810    845337.0
    Name: adgroupId, Length: 731, dtype: float64




```python
#根据类别到对应关系表中 随机选择当前类别下的200个广告
np.random.choice(pdf.where(pdf.cateId ==11156).dropna().adgroupId.astype(np.int64),200)
```




    array([514192,  83221,  92842, 236580, 729266, 523554, 576799, 638359,
           556716, 237729, 403185, 579680, 251796, 828290, 306018, 661774,
           807871, 729926, 435626, 212226, 395121, 415875, 611740, 427537,
           136480, 194101, 766865, 142188, 233373, 298413, 245276, 346230,
            51054, 666351, 472274, 152063, 727649, 505655,  13858,  92842,
            85423, 664650, 191584, 237471, 181455, 762867, 565416, 147231,
            56800, 407365, 610540,  10617, 394104, 341101, 333855, 364325,
           307451, 238772,  31382,  89089, 154015,  28224, 277013,  99933,
           258224, 384104, 456353, 304065,   7317, 659328, 132579, 133970,
            97235, 576860, 415875, 618101, 551501, 261067, 240336, 752918,
           706818, 447492, 129365, 277355, 835263, 269973, 214210, 241873,
           252263, 299950, 612679, 760285, 417290, 238761, 258970,  66710,
           232364, 362888, 316048, 551585, 123070, 121517, 189861,  83221,
           580399, 350371, 732754, 752918, 205710,  97639, 238592, 437632,
           168883, 232364, 343454, 235106, 457257, 728579,   8128,  60736,
           314196, 417255, 187501,  84654, 126785, 679904, 317989, 421995,
           132623, 688335,  61539,  13858,  70178, 838953, 396826, 198285,
           171575, 187501, 727649, 772099, 813551, 699110, 361665, 121863,
           175987, 187501, 668118, 774941,  53437, 711384, 175490,  61255,
           761375, 447492, 446814, 814824, 200848, 407297,  95491, 735706,
            97639, 403208, 325001, 230861, 670031,  56800, 760285, 334249,
           358612, 551589, 352273, 210049, 556631, 232586, 744661, 691915,
           261739, 284183,  42699, 318736, 796985, 760285,  88322, 711384,
           435626, 556631, 660174, 209119, 207498, 270447, 228785, 435626,
           375085, 100707, 416290, 110509, 629210, 422745, 661774, 269520])




```python
# 给用户找到感兴趣的类别
als_model.userFactors.show()
```

    +---+--------------------+
    | id|            features|
    +---+--------------------+
    |  8|[0.34110302, 0.58...|
    | 18|[0.26234755, 0.05...|
    | 28|[-0.42565244, 0.5...|
    | 38|[-0.17222986, 0.1...|
    | 48|[-0.7299992, 0.03...|
    | 58|[0.20949, 0.78875...|
    | 68|[-2.1288443, 0.13...|
    | 78|[0.20121495, 0.68...|
    | 88|[0.57730436, 0.16...|
    | 98|[0.22689435, 0.80...|
    |108|[-0.32026184, 0.1...|
    |118|[-0.06577069, 0.6...|
    |128|[0.3708652, 0.523...|
    |138|[-0.31295472, -0....|
    |148|[-0.032690633, 0....|
    |158|[-0.05601896, 0.0...|
    |168|[0.58979905, 0.16...|
    |178|[0.14070545, 0.80...|
    |188|[0.17815629, 0.59...|
    |198|[-0.34739748, 1.6...|
    +---+--------------------+
    only showing top 20 rows


​    


```python
# 为指定用户预测所有类别的评分
cateId_df = pd.DataFrame(pdf.cateId.unique(),columns=['cateId'])
```


```python
cateId_df.insert(0,'userId',np.array([8 for i in range(6769)]))
```


```python
als_model.transform(spark.createDataFrame(cateId_df)).sort('prediction',ascending = False).na.drop().show()
```

    +------+------+----------+
    |userId|cateId|prediction|
    +------+------+----------+
    |     8|  8882| 7.0304847|
    |     8|  5993|  5.751598|
    |     8| 12282|  5.327876|
    |     8|  6734|    5.2168|
    |     8|  6421| 5.1464972|
    |     8|  1155|  4.995791|
    |     8|   856|  4.618875|
    |     8|  6261| 4.5706525|
    |     8|  2767| 4.5490074|
    |     8|  1101| 4.5368094|
    |     8|  7752| 4.2273746|
    |     8| 11752| 4.1914773|
    |     8|  2468| 4.1329217|
    |     8|  6617| 3.9452367|
    |     8|  7214| 3.8621702|
    |     8|  8340| 3.7554228|
    |     8|  8348| 3.6372938|
    |     8|  1157| 3.6295743|
    |     8|   841|  3.499203|
    |     8|   184| 3.3779442|
    +------+------+----------+
    only showing top 20 rows


​    


```python
#为用户召回商品
# 遍历UserFactors 找到每一个用户 为每一个用户建立 User 所有类别  dataframe 
# 利用ALS模型 预测用户对所有类别的评分值 把评分高的排在前面
# 利用排在前面的类别到 类别-广告的对应关系表中随机抽取商品 抽取出来放到redis当中
import redis
client = redis.StrictRedis(host = '192.168.2.137',port=6379,db = 6)
for r in als_model.userFactors.select('id').collect():
    userId = r.id
    cateId_df = pd.DataFrame(pdf.cateId.unique(),columns=['cateId'])
    cateId_df.insert(0,'userId',np.array([userId for i in range(6769)]))
    ret = set()
    cateId_list = als_model.transform(spark.createDataFrame(cateId_df)).sort('prediction',ascending = False).na.drop()
    #从cateId_list取出前20个结果
    for i in cateId_list.head(20):
        need = 500-len(ret)
        ret = ret.union(np.random.choice(pdf.where(pdf.cateId ==i).dropna().adgroupId.astype(np.int64),need))
        if len(ret)>=500:
            break
    client.sadd(userId,*ret)
```


    ---------------------------------------------------------------------------
    
    ValueError                                Traceback (most recent call last)
    
    <ipython-input-159-15a783632201> in <module>
         14     for i in cateId_list.head(20):
         15         need = 500-len(ret)
    ---> 16         ret = ret.union(np.random.choice(pdf.where(pdf.cateId ==i).dropna().adgroupId.astype(np.int64),need))
         17         if len(ret)>=500:
         18             break


    mtrand.pyx in mtrand.RandomState.choice()


    ValueError: 'a' cannot be empty unless no samples are taken



```python
import numpy as np
import pandas as pd

import redis

# 存储用户召回，使用redis第9号数据库，类型：sets类型
client = redis.StrictRedis(host="192.168.2.137", port=6379, db=6)
# 遍历als_model 中 所有用户的id
for r in als_model.userFactors.select("id").collect():

    userId = r.id

    #准备 当前用户 和 所有类别 一一对应的dataframe
    cateId_df = pd.DataFrame(pdf.cateId.unique(),columns=["cateId"])
    cateId_df.insert(0, "userId", np.array([userId for i in range(6769)]))
    ret = set()

    # 利用模型，传入datasets(userId, cateId)，这里控制了userId一样，所以相当于是在求某用户对所有分类的兴趣程度
    cateId_list = als_model.transform(spark.createDataFrame(cateId_df)).sort("prediction", ascending=False).na.drop()
    # 找到前 20个 最感兴趣的类别 从前20个分类中选出500个进行召回
    for i in cateId_list.head(20):
        need = 500 - len(ret)    # 如果不足500个，那么随机选出need个广告
        ret = ret.union(np.random.choice(pdf.where(pdf.cateId==i.cateId).adgroupId.dropna().astype(np.int64), need))
        if len(ret) >= 500:    # 如果达到500个则退出
            break
    client.sadd(userId, *ret)
```


    ---------------------------------------------------------------------------
    
    KeyboardInterrupt                         Traceback (most recent call last)
    
    <ipython-input-160-3b2a4f020bca> in <module>
         19     cateId_list = als_model.transform(spark.createDataFrame(cateId_df)).sort("prediction", ascending=False).na.drop()
         20     # 找到前 20个 最感兴趣的类别 从前20个分类中选出500个进行召回
    ---> 21     for i in cateId_list.head(20):
         22         need = 500 - len(ret)    # 如果不足500个，那么随机选出need个广告
         23         ret = ret.union(np.random.choice(pdf.where(pdf.cateId==i.cateId).adgroupId.dropna().astype(np.int64), need))


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/sql/dataframe.py in head(self, n)
        970             rs = self.head(1)
        971             return rs[0] if rs else None
    --> 972         return self.take(n)
        973 
        974     @ignore_unicode_prefix


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/sql/dataframe.py in take(self, num)
        474         [Row(age=2, name=u'Alice'), Row(age=5, name=u'Bob')]
        475         """
    --> 476         return self.limit(num).collect()
        477 
        478     @since(1.3)


    /miniconda2/envs/py365/lib/python3.6/site-packages/pyspark-2.2.2-py3.6.egg/pyspark/sql/dataframe.py in collect(self)
        436         """
        437         with SCCallSiteSync(self._sc) as css:
    --> 438             sock_info = self._jdf.collectToPython()
        439         return list(_load_from_socket(sock_info, BatchedSerializer(PickleSerializer())))
        440 


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in __call__(self, *args)
       1253             proto.END_COMMAND_PART
       1254 
    -> 1255         answer = self.gateway_client.send_command(command)
       1256         return_value = get_return_value(
       1257             answer, self.gateway_client, self.target_id, self.name)


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in send_command(self, command, retry, binary)
        983         connection = self._get_connection()
        984         try:
    --> 985             response = connection.send_command(command)
        986             if binary:
        987                 return response, self._create_connection_guard(connection)


    /miniconda2/envs/py365/lib/python3.6/site-packages/py4j-0.10.7-py3.6.egg/py4j/java_gateway.py in send_command(self, command)
       1150 
       1151         try:
    -> 1152             answer = smart_decode(self.stream.readline()[:-1])
       1153             logger.debug("Answer received: {0}".format(answer))
       1154             if answer.startswith(proto.RETURN_MESSAGE):


    /miniconda2/envs/py365/lib/python3.6/socket.py in readinto(self, b)
        584         while True:
        585             try:
    --> 586                 return self._sock.recv_into(b)
        587             except timeout:
        588                 self._timeout_occurred = True


    KeyboardInterrupt: 



```python
# 缓存商品的特征 缓存了价格
def foreachPartition(partition):

    import redis
    import json
    client = redis.StrictRedis(host="192.168.2.137", port=6379, db=2)

    for r in partition:
        data = {
            "price": r.price
        }
        # 转成json字符串再保存，能保证数据再次倒出来时，能有效的转换成python类型
        client.hset("ad_features", r.adgroupId, json.dumps(data))

ad_feature_df.foreachPartition(foreachPartition)
```


```python
def foreachPartition2(partition):

    import redis
    import json
    client = redis.StrictRedis(host="192.168.2.137", port=6379, db=3)

    for r in partition:
        data = {
            "cms_segid": r.cms_segid,
            "cms_group_id": r.cms_group_id,
            "final_gender_code": r.final_gender_code,
            "age_level": r.age_level,
            "shopping_level": r.shopping_level,
            "occupation": r.occupation,
            "pvalue_level": r.pvalue_level,
            "new_user_class_level": r.new_user_class_level
        }
        # 转成json字符串再保存，能保证数据再次倒出来时，能有效的转换成python类型
        client.hset("user_features1", r.userId, json.dumps(data))

user_profile_df.foreachPartition(foreachPartition2)
```


```python
pvalue_level_rela = {-1:0, 3:3, 1:2, 2:1}
new_user_class_level_rela = {-1:0, 3:2, 1:4, 4:3, 2:1}
pid_rela = {"430548_1007": 0, "430549_1007": 1}
```


```python
import redis
import json
import pandas as pd
from pyspark.ml.linalg import DenseVector

# 需要传递两个值  用户的id 广告资源位
def create_datasets(userId, pid):
    client_of_recall = redis.StrictRedis(host="192.168.2.137", port=6379, db=9)
    client_of_features = redis.StrictRedis(host="192.168.2.137", port=6379, db=4)
    # 获取用户特征
    user_feature = json.loads(client_of_features.hget("user_features", userId))
    
    # 获取用户召回集
    recall_sets = client_of_recall.smembers(userId)
    
    result = []
    
    # 遍历召回集
    for adgroupId in recall_sets:
        adgroupId = int(adgroupId)
        # 获取该广告的特征值
        ad_feature = json.loads(client_of_features.hget("ad_features", adgroupId))
        
        features = {}
        features.update(user_feature)
        features.update(ad_feature)

        for k,v in features.items():
            if v is None:
                features[k] = -1

        features_col = [
            # 特征值
            "price",
            "cms_segid",
            "cms_group_id",
            "final_gender_code",
            "age_level",
            "shopping_level",
            "occupation",
            "pid", 
            "pvalue_level",
            "new_user_class_level"
        ]
        '''
        "cms_group_id", 类别型特征，约13个分类 ==> 13维
        "final_gender_code", 类别型特征，2个分类 ==> 2维
        "age_level", 类别型特征，7个分类 ==>7维
        "shopping_level", 类别型特征，3个分类 ==> 3维
        "occupation", 类别型特征，2个分类 ==> 2维
        '''

        price = float(features["price"])

        pid_value = [0 for i in range(2)]#[0,0]
        pvalue_level_value = [0 for i in range(4)]# [0,0,0,0]
        new_user_class_level_value = [0 for i in range(5)] # [0,0,0,0,0]

        pid_value[pid_rela[pid]] = 1 #[1,0]
        pvalue_level_value[pvalue_level_rela[int(features["pvalue_level"])]] = 1
        new_user_class_level_value[new_user_class_level_rela[int(features["new_user_class_level"])]] = 1
        vector = DenseVector([price] + pid_value + [int(features["cms_segid"])]+[int(features["cms_group_id"])] + [int(features["final_gender_code"])]\
        + [int(features["age_level"])] + [int(features["shopping_level"])] +[int(features["occupation"])] + pvalue_level_value + new_user_class_level_value)

        result.append((userId, adgroupId, vector))
        
    return result
```


```python
# 传入用户ID和广告资源位 返回当前用户的召回集对应的物品特征，以及用户特特征
create_datasets(88, "430548_1007")
```




    [(88,
      302979,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      373603,
      DenseVector([79.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      618710,
      DenseVector([45.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      663693,
      DenseVector([39.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      281152,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      164432,
      DenseVector([60.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      284485,
      DenseVector([29.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      342729,
      DenseVector([2.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      150883,
      DenseVector([75.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      101024,
      DenseVector([1.72, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      173046,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      219865,
      DenseVector([245.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      832132,
      DenseVector([42.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      749594,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      65138,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      309164,
      DenseVector([1.3, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      462824,
      DenseVector([8.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      31509,
      DenseVector([11.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      141784,
      DenseVector([9.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      728181,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      380275,
      DenseVector([1.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      700378,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      189095,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      262143,
      DenseVector([4.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      493669,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      247045,
      DenseVector([130.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      821502,
      DenseVector([59.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      834186,
      DenseVector([43.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      676572,
      DenseVector([8.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      467141,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      435445,
      DenseVector([1.78, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      266502,
      DenseVector([69.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      522910,
      DenseVector([0.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      398834,
      DenseVector([11.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      324478,
      DenseVector([32.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      141488,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      321405,
      DenseVector([168.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      73103,
      DenseVector([4.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      203976,
      DenseVector([119.4, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      258248,
      DenseVector([2.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      128803,
      DenseVector([14.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      360399,
      DenseVector([1.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      454288,
      DenseVector([6.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      451390,
      DenseVector([40.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      405968,
      DenseVector([159.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      99277,
      DenseVector([149.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      331342,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      186649,
      DenseVector([64.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      729270,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      105129,
      DenseVector([9.99, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      307103,
      DenseVector([1.4, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      330007,
      DenseVector([65.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      514842,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      728220,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      351995,
      DenseVector([2.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      194329,
      DenseVector([23.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      317885,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      301435,
      DenseVector([268.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      319791,
      DenseVector([215.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      351884,
      DenseVector([1.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      369521,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      236731,
      DenseVector([108.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      10391,
      DenseVector([4.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      12890,
      DenseVector([1.78, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      337830,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      682651,
      DenseVector([3.99, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      67102,
      DenseVector([2.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      201994,
      DenseVector([11.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      786678,
      DenseVector([6.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      376347,
      DenseVector([9.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      319953,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      60535,
      DenseVector([17.7, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      578727,
      DenseVector([129.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      64269,
      DenseVector([130.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      563571,
      DenseVector([12.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      338838,
      DenseVector([80.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      114669,
      DenseVector([218.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      613688,
      DenseVector([300.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      483405,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      122260,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      359991,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      387080,
      DenseVector([5.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      181941,
      DenseVector([0.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      828146,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      137008,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      31832,
      DenseVector([15.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      374563,
      DenseVector([8.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      308002,
      DenseVector([66.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      765312,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      134756,
      DenseVector([88.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      660243,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      832640,
      DenseVector([169.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      110737,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      522549,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      740675,
      DenseVector([49.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      258179,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      511688,
      DenseVector([98.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      652815,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      129281,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      243986,
      DenseVector([39.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      712333,
      DenseVector([12.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      139616,
      DenseVector([2.3, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      263990,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      97521,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      266596,
      DenseVector([357.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      561127,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      745505,
      DenseVector([57.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      747578,
      DenseVector([59.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      368826,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      561986,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      36260,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      312684,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      715943,
      DenseVector([17.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      166337,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      335781,
      DenseVector([4.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      66735,
      DenseVector([68.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      40238,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      647831,
      DenseVector([2.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      803354,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      271128,
      DenseVector([196.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      425813,
      DenseVector([17.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      133678,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      240982,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      344281,
      DenseVector([19.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      298695,
      DenseVector([1.4, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      777574,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      823808,
      DenseVector([2.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      116093,
      DenseVector([68.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      238137,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      593655,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      172220,
      DenseVector([29.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      488583,
      DenseVector([0.65, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      174803,
      DenseVector([1.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      827003,
      DenseVector([18.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      828946,
      DenseVector([9.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      28935,
      DenseVector([39.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      546880,
      DenseVector([45.68, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      641215,
      DenseVector([32.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      349885,
      DenseVector([6.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      205905,
      DenseVector([7.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      179324,
      DenseVector([6.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      576487,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      100985,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      630264,
      DenseVector([216.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      536081,
      DenseVector([45.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      523985,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      221716,
      DenseVector([6.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      142437,
      DenseVector([44.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      772024,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      801326,
      DenseVector([4.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      110741,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      742468,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      395023,
      DenseVector([29.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      344372,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      761074,
      DenseVector([14.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      467524,
      DenseVector([2.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      422243,
      DenseVector([13.75, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      720313,
      DenseVector([28.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      104911,
      DenseVector([3.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      167729,
      DenseVector([6.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      331531,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      309071,
      DenseVector([7.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      64866,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      68112,
      DenseVector([38.86, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      108065,
      DenseVector([0.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      290056,
      DenseVector([1.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      180639,
      DenseVector([2.3, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      597536,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      330138,
      DenseVector([0.4, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      765683,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      353936,
      DenseVector([8.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      11892,
      DenseVector([28.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      81332,
      DenseVector([11.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      203670,
      DenseVector([23.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      313853,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      611381,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      393163,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      841421,
      DenseVector([172.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      150611,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      158832,
      DenseVector([80.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      609582,
      DenseVector([300.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      719379,
      DenseVector([13.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      726879,
      DenseVector([28.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      172534,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      66957,
      DenseVector([0.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      195609,
      DenseVector([5.99, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      393164,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      299049,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      466576,
      DenseVector([0.65, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      482196,
      DenseVector([10.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      760630,
      DenseVector([200.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      86644,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      251421,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      313572,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      179355,
      DenseVector([13.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      318676,
      DenseVector([17.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      175696,
      DenseVector([2.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      535137,
      DenseVector([90.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      229586,
      DenseVector([90.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      115533,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      301406,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      350800,
      DenseVector([198.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      243466,
      DenseVector([60.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      466607,
      DenseVector([1.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      103798,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      484545,
      DenseVector([39.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      488534,
      DenseVector([5.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      515617,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      257867,
      DenseVector([28.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      73790,
      DenseVector([288.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      526867,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      325409,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      230928,
      DenseVector([298.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      345662,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      676692,
      DenseVector([13.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      149543,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      550611,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      260019,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      729488,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      8412,
      DenseVector([0.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      564796,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      116299,
      DenseVector([8.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      133037,
      DenseVector([27.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      619431,
      DenseVector([39.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      326218,
      DenseVector([196.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      285258,
      DenseVector([90.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      500007,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      194403,
      DenseVector([158.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      698201,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      769698,
      DenseVector([2.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      87778,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      571416,
      DenseVector([7.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      260490,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      786325,
      DenseVector([44.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      261300,
      DenseVector([1.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      373018,
      DenseVector([104.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      168054,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      307241,
      DenseVector([168.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      779315,
      DenseVector([236.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      725551,
      DenseVector([6.98, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      741355,
      DenseVector([40.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      354791,
      DenseVector([28.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      412235,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      15565,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      390351,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      425710,
      DenseVector([19.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      205631,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      48430,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      410497,
      DenseVector([5.43, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      587281,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      268955,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      179895,
      DenseVector([60.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      325479,
      DenseVector([69.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      53177,
      DenseVector([90.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      770139,
      DenseVector([90.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      378724,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      189518,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      761574,
      DenseVector([88.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      831504,
      DenseVector([43.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      170013,
      DenseVector([79.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      754140,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      209853,
      DenseVector([210.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      488618,
      DenseVector([0.65, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      497146,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      297573,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      103079,
      DenseVector([79.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      211549,
      DenseVector([9.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      132185,
      DenseVector([24.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      240983,
      DenseVector([0.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      588195,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      648910,
      DenseVector([18.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      64513,
      DenseVector([45.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      651127,
      DenseVector([298.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      426366,
      DenseVector([9.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      404816,
      DenseVector([60.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      304283,
      DenseVector([11.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      132668,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      319074,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      601279,
      DenseVector([20.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      364151,
      DenseVector([1.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      786462,
      DenseVector([37.4, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      713286,
      DenseVector([60.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      392071,
      DenseVector([39.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      139534,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      821465,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      149399,
      DenseVector([11.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      388392,
      DenseVector([2.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      504194,
      DenseVector([131.25, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      405297,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      420206,
      DenseVector([0.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      454384,
      DenseVector([7.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      500024,
      DenseVector([48.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      548619,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      743831,
      DenseVector([3.98, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      163470,
      DenseVector([120.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      745579,
      DenseVector([88.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      743609,
      DenseVector([259.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      505987,
      DenseVector([2.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      459582,
      DenseVector([1.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      72279,
      DenseVector([83.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      222295,
      DenseVector([15.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      727053,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      777999,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      222453,
      DenseVector([9.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      315802,
      DenseVector([109.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      149817,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      323260,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      717136,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      810476,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      451,
      DenseVector([26.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      360027,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      158695,
      DenseVector([1.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      183363,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      380982,
      DenseVector([100.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      136901,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      308549,
      DenseVector([17.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      362670,
      DenseVector([9.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      763932,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      201108,
      DenseVector([1.1, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      802393,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      52656,
      DenseVector([23.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      186627,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      786674,
      DenseVector([30.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      313840,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      97922,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      786545,
      DenseVector([24.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      199830,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      173763,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      171488,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      136815,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      241,
      DenseVector([2.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      483359,
      DenseVector([7.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      323800,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      148446,
      DenseVector([9.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      153139,
      DenseVector([158.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      719322,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      740205,
      DenseVector([146.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      94189,
      DenseVector([144.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      25949,
      DenseVector([1.28, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      501107,
      DenseVector([39.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      676688,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      420525,
      DenseVector([28.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      696278,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      802887,
      DenseVector([13.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      705,
      DenseVector([16.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      321690,
      DenseVector([17.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      312549,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      193235,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      101640,
      DenseVector([1.72, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      411297,
      DenseVector([500.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      160370,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      776641,
      DenseVector([3.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      743585,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      328020,
      DenseVector([22.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      698445,
      DenseVector([398.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      404906,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      611515,
      DenseVector([1.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      520326,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      292046,
      DenseVector([29.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      464202,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      779258,
      DenseVector([199.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      431379,
      DenseVector([389.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      392358,
      DenseVector([88.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      93056,
      DenseVector([7.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      590203,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      545082,
      DenseVector([71.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      310046,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      313569,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      726801,
      DenseVector([70.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      205003,
      DenseVector([410.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      380407,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      530394,
      DenseVector([15.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      177343,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      338686,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      130146,
      DenseVector([218.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      638950,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      536318,
      DenseVector([19.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      251572,
      DenseVector([4.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      393167,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      810845,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      151770,
      DenseVector([158.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      294440,
      DenseVector([37.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      479095,
      DenseVector([6.66, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      337716,
      DenseVector([3.3, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      178911,
      DenseVector([380.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      300064,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      112141,
      DenseVector([9.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      769586,
      DenseVector([65.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      379352,
      DenseVector([55.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      304580,
      DenseVector([13.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      167827,
      DenseVector([3.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      426418,
      DenseVector([9.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      496897,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      432613,
      DenseVector([3.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      12867,
      DenseVector([19.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      258550,
      DenseVector([6.7, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      427288,
      DenseVector([25.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      51883,
      DenseVector([3.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      414435,
      DenseVector([4.18, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      281969,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      295914,
      DenseVector([1.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      184540,
      DenseVector([185.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      606543,
      DenseVector([5.98, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      70188,
      DenseVector([14.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      733109,
      DenseVector([40.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      500562,
      DenseVector([2.15, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      306475,
      DenseVector([9.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      526798,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      121581,
      DenseVector([9.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      207961,
      DenseVector([7.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      137874,
      DenseVector([65.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      550530,
      DenseVector([16.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      124044,
      DenseVector([27.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      299573,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      63853,
      DenseVector([2.7, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      238171,
      DenseVector([18.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      658547,
      DenseVector([19.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      799604,
      DenseVector([30.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      77819,
      DenseVector([68.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      447832,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      735639,
      DenseVector([90.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      145463,
      DenseVector([26.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      312894,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      723486,
      DenseVector([19.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      764529,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      832547,
      DenseVector([69.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      3558,
      DenseVector([1.4, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      446803,
      DenseVector([2.96, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      621539,
      DenseVector([6.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      364027,
      DenseVector([3.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      83521,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      651698,
      DenseVector([7.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      518181,
      DenseVector([175.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      383682,
      DenseVector([12.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      822117,
      DenseVector([5.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      495635,
      DenseVector([7.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      373192,
      DenseVector([2.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      571667,
      DenseVector([58.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      699217,
      DenseVector([68.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      818292,
      DenseVector([13.14, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      126350,
      DenseVector([1.3, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      173350,
      DenseVector([11.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      763930,
      DenseVector([49.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      149356,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      536589,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      388405,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      510063,
      DenseVector([1.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      509709,
      DenseVector([8.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      441938,
      DenseVector([197.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      723046,
      DenseVector([80.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      837628,
      DenseVector([21.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      177302,
      DenseVector([230.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      399956,
      DenseVector([280.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      688166,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      717433,
      DenseVector([4.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      99310,
      DenseVector([9.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      119841,
      DenseVector([15.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      741730,
      DenseVector([98.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      440469,
      DenseVector([99.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      471446,
      DenseVector([3.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      61846,
      DenseVector([0.98, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      341340,
      DenseVector([29.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      83325,
      DenseVector([13.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      768285,
      DenseVector([172.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      583410,
      DenseVector([9.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      649382,
      DenseVector([6.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      563223,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      32580,
      DenseVector([70.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      365286,
      DenseVector([198.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      821405,
      DenseVector([59.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      343907,
      DenseVector([17.9, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      641157,
      DenseVector([10.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      332318,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      459337,
      DenseVector([12.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      498759,
      DenseVector([29.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      396399,
      DenseVector([7.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      520752,
      DenseVector([48.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      116569,
      DenseVector([98.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      715959,
      DenseVector([1.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      219568,
      DenseVector([50.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      421762,
      DenseVector([13.75, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      260746,
      DenseVector([36.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      229745,
      DenseVector([15.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      674338,
      DenseVector([9.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      774367,
      DenseVector([3.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      239474,
      DenseVector([2.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      53329,
      DenseVector([18.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      404942,
      DenseVector([7.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      774241,
      DenseVector([45.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      611548,
      DenseVector([2.2, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      90981,
      DenseVector([20.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      385926,
      DenseVector([70.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      121893,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      738934,
      DenseVector([5.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      514526,
      DenseVector([3.8, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      168226,
      DenseVector([3.5, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      182924,
      DenseVector([35.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      241399,
      DenseVector([38.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      764679,
      DenseVector([59.0, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0])),
     (88,
      281427,
      DenseVector([13.6, 1.0, 0.0, 1.0, 1.0, 2.0, 1.0, 2.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0, 0.0, 1.0, 0.0, 0.0]))]




```python
from pyspark.ml.classification import LogisticRegressionModel
# 加载逻辑回归模型 对所有的商品进行排序
CTR_model = LogisticRegressionModel.load("/models/CTRModel_Normal.obj")
#创建Pandas的dataframe 指定三列 用户id 广告id 特征向量
pdf = pd.DataFrame(create_datasets(8, "430548_1007"), columns=["userId", "adgroupId", "features"])
datasets = spark.createDataFrame(pdf)
datasets.show()
```

    +------+---------+--------------------+
    |userId|adgroupId|            features|
    +------+---------+--------------------+
    |     8|    68707|[0.40000000596046...|
    |     8|   175171|[20.0,1.0,0.0,0.0...|
    |     8|   695818|[12.0,1.0,0.0,0.0...|
    |     8|   184377|[10.0,1.0,0.0,0.0...|
    |     8|    60863|[23.7999992370605...|
    |     8|   521951|[39.9900016784668...|
    |     8|   363430|[26.0,1.0,0.0,0.0...|
    |     8|   214003|[0.30000001192092...|
    |     8|   347039|[0.57999998331069...|
    |     8|    13674|[60.0,1.0,0.0,0.0...|
    |     8|   559536|[0.68000000715255...|
    |     8|   216154|[399.0,1.0,0.0,0....|
    |     8|   107532|[2.0,1.0,0.0,0.0,...|
    |     8|   169694|[5.80000019073486...|
    |     8|   125077|[1.39999997615814...|
    |     8|    36216|[0.36000001430511...|
    |     8|   115502|[14.0,1.0,0.0,0.0...|
    |     8|   228700|[0.34999999403953...|
    |     8|    61331|[24.2000007629394...|
    |     8|   111178|[4.0,1.0,0.0,0.0,...|
    +------+---------+--------------------+
    only showing top 20 rows


​    


```python
# 利用逻辑回归的模型 预测物品的点击率 按照probability 从小到大进行排列
prediction = CTR_model.transform(datasets).sort("probability")
prediction.show()
```

    +------+---------+--------------------+--------------------+--------------------+----------+
    |userId|adgroupId|            features|       rawPrediction|         probability|prediction|
    +------+---------+--------------------+--------------------+--------------------+----------+
    |     8|    20960|[0.01999999955296...|[2.85325656201211...|[0.94548677469601...|       0.0|
    |     8|   124308|[0.10000000149011...|[2.85436919882271...|[0.94554409328680...|       0.0|
    |     8|   359671|[0.11999999731779...|[2.85464735796060...|[0.94555841405413...|       0.0|
    |     8|   254857|[0.20000000298023...|[2.85575999482301...|[0.94561566165427...|       0.0|
    |     8|    63265|[0.20000000298023...|[2.85575999482301...|[0.94561566165427...|       0.0|
    |     8|    54646|[0.23999999463558...|[2.85631631309879...|[0.94564426416596...|       0.0|
    |     8|   480794|[0.25,1.0,0.0,0.0...|[2.85645539277135...|[0.94565141258354...|       0.0|
    |     8|   152250|[0.28999999165534...|[2.85701171104713...|[0.94567999737273...|       0.0|
    |     8|   114680|[0.28999999165534...|[2.85701171104713...|[0.94567999737273...|       0.0|
    |     8|   511147|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   460815|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   214003|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   110159|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   209722|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   369757|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   333633|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   265605|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   369756|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|    30125|[0.30000001192092...|[2.85715079092694...|[0.94568714137153...|       0.0|
    |     8|   228700|[0.34999999403953...|[2.85784618866803...|[0.94572284799825...|       0.0|
    +------+---------+--------------------+--------------------+--------------------+----------+
    only showing top 20 rows


​    


```python
prediction.select('adgroupId').head(10)
```




    [Row(adgroupId=20960),
     Row(adgroupId=124308),
     Row(adgroupId=359671),
     Row(adgroupId=63265),
     Row(adgroupId=254857),
     Row(adgroupId=54646),
     Row(adgroupId=480794),
     Row(adgroupId=114680),
     Row(adgroupId=152250),
     Row(adgroupId=209722)]




```python
[i.adgroupId for i in prediction.select("adgroupId").head(10)]
```




    [20960, 124308, 359671, 63265, 254857, 54646, 480794, 152250, 114680, 214003]


